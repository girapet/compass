const n=n=>n instanceof Array?n:n instanceof HTMLElement||n instanceof HTMLDocument?[n]:n instanceof HTMLCollection?Array.from(n):void 0,m=(m,t)=>{const e=n(t);if(!e)throw new Error("invalid child elements");e.forEach(n=>m.appendChild(n))},t=(m,t)=>{const e=n(m);if(!e)throw new Error("invalid target");e.forEach(n=>t(n))},e=n=>"String"===n.constructor.name||n instanceof Array||n instanceof HTMLElement||n instanceof HTMLCollection;var o=m,a=(n,...t)=>{const o=document.createElement(n),a=t.find(n=>!e(n));a&&Object.assign(o,a);const i=t.find(e);return i&&("String"===i.constructor.name?o.innerHTML=i:m(o,i)),o},i=(...n)=>{const m=n.pop(),t=n.length?n[0]:document;return Array.from(t.querySelectorAll(m))},d=n=>document.getElementById(n),r=(n,m,e)=>t(n,n=>n.addEventListener(m,e));const s={video:{facingMode:{exact:"environment"},width:{ideal:window.innerHeight},height:{ideal:window.innerWidth}}},h=async()=>{let n;try{n=await navigator.mediaDevices.getUserMedia(s)}catch{}return n};var c=async()=>{if(!navigator.mediaDevices)return"No camera available";if("denied"===(await navigator.permissions.query({name:"camera"})).state)return"Permission to use this device's camera was denied";let n=await h();if(!n)return"No front-facing camera available";const m=d("video-container");let t;const e=async()=>{"visible"===document.visibilityState?t||(n||(n=await h()),t=a("video",{autoplay:!0,mute:!0}),o(m,t),t.srcObject=n):t&&(t.srcObject.getTracks().forEach(n=>n.stop()),t.remove(),t=void 0,n=void 0)};await e(),r(document,"visibilitychange",e)};const g=Math.PI/180,l=1/g,f=n=>n*g,u=n=>n*l,v=n=>(n%=360)>=0?n:n+360;var p={rad:f,deg:u,rev:v};const w=(n,m)=>{const t=new Array(n);if(void 0!==m){const e=m instanceof Function;for(let o=0;o<n;o++)t[o]=e?m():m}return t},{sqrt:y,sin:b,cos:k,atan2:T,abs:S}=Math,M=w(13,()=>w(13)),x=w(13,()=>w(13)),H=w(13,()=>w(13)),A=w(13,()=>w(13)),E=w(13,()=>w(13)),P=w(13),L=w(13),F=w(13),C=w(13),q=w(13),B=w(13,()=>w(13)),$=w(13,()=>w(13));P[0]=0,L[0]=1,$[0][0]=1,q[0]=1,A[0][0]=0;const W=6378.137,O=6356.7523142,I=W*W,D=O*O,N=I-D,j=I*I,U=j-D*D;M[0][0]=0,x[0][0]=0;const{epoch:z,model:R}={epoch:2025,model:[{n:1,m:0,gnm:-29351.8,hnm:0,dgnm:12,dhnm:0},{n:1,m:1,gnm:-1410.8,hnm:4545.4,dgnm:9.7,dhnm:-21.5},{n:2,m:0,gnm:-2556.6,hnm:0,dgnm:-11.6,dhnm:0},{n:2,m:1,gnm:2951.1,hnm:-3133.6,dgnm:-5.2,dhnm:-27.7},{n:2,m:2,gnm:1649.3,hnm:-815.1,dgnm:-8,dhnm:-12.1},{n:3,m:0,gnm:1361,hnm:0,dgnm:-1.3,dhnm:0},{n:3,m:1,gnm:-2404.1,hnm:-56.6,dgnm:-4.2,dhnm:4},{n:3,m:2,gnm:1243.8,hnm:237.5,dgnm:.4,dhnm:-.3},{n:3,m:3,gnm:453.6,hnm:-549.5,dgnm:-15.6,dhnm:-4.1},{n:4,m:0,gnm:895,hnm:0,dgnm:-1.6,dhnm:0},{n:4,m:1,gnm:799.5,hnm:278.6,dgnm:-2.4,dhnm:-1.1},{n:4,m:2,gnm:55.7,hnm:-133.9,dgnm:-6,dhnm:4.1},{n:4,m:3,gnm:-281.1,hnm:212,dgnm:5.6,dhnm:1.6},{n:4,m:4,gnm:12.1,hnm:-375.6,dgnm:-7,dhnm:-4.4},{n:5,m:0,gnm:-233.2,hnm:0,dgnm:.6,dhnm:0},{n:5,m:1,gnm:368.9,hnm:45.4,dgnm:1.4,dhnm:-.5},{n:5,m:2,gnm:187.2,hnm:220.2,dgnm:0,dhnm:2.2},{n:5,m:3,gnm:-138.7,hnm:-122.9,dgnm:.6,dhnm:.4},{n:5,m:4,gnm:-142,hnm:43,dgnm:2.2,dhnm:1.7},{n:5,m:5,gnm:20.9,hnm:106.1,dgnm:.9,dhnm:1.9},{n:6,m:0,gnm:64.4,hnm:0,dgnm:-.2,dhnm:0},{n:6,m:1,gnm:63.8,hnm:-18.4,dgnm:-.4,dhnm:.3},{n:6,m:2,gnm:76.9,hnm:16.8,dgnm:.9,dhnm:-1.6},{n:6,m:3,gnm:-115.7,hnm:48.8,dgnm:1.2,dhnm:-.4},{n:6,m:4,gnm:-40.9,hnm:-59.8,dgnm:-.9,dhnm:.9},{n:6,m:5,gnm:14.9,hnm:10.9,dgnm:.3,dhnm:.7},{n:6,m:6,gnm:-60.7,hnm:72.7,dgnm:.9,dhnm:.9},{n:7,m:0,gnm:79.5,hnm:0,dgnm:0,dhnm:0},{n:7,m:1,gnm:-77,hnm:-48.9,dgnm:-.1,dhnm:.6},{n:7,m:2,gnm:-8.8,hnm:-14.4,dgnm:-.1,dhnm:.5},{n:7,m:3,gnm:59.3,hnm:-1,dgnm:.5,dhnm:-.8},{n:7,m:4,gnm:15.8,hnm:23.4,dgnm:-.1,dhnm:0},{n:7,m:5,gnm:2.5,hnm:-7.4,dgnm:-.8,dhnm:-1},{n:7,m:6,gnm:-11.1,hnm:-25.1,dgnm:-.8,dhnm:.6},{n:7,m:7,gnm:14.2,hnm:-2.3,dgnm:.8,dhnm:-.2},{n:8,m:0,gnm:23.2,hnm:0,dgnm:-.1,dhnm:0},{n:8,m:1,gnm:10.8,hnm:7.1,dgnm:.2,dhnm:-.2},{n:8,m:2,gnm:-17.5,hnm:-12.6,dgnm:0,dhnm:.5},{n:8,m:3,gnm:2,hnm:11.4,dgnm:.5,dhnm:-.4},{n:8,m:4,gnm:-21.7,hnm:-9.7,dgnm:-.1,dhnm:.4},{n:8,m:5,gnm:16.9,hnm:12.7,dgnm:.3,dhnm:-.5},{n:8,m:6,gnm:15,hnm:.7,dgnm:.2,dhnm:-.6},{n:8,m:7,gnm:-16.8,hnm:-5.2,dgnm:0,dhnm:.3},{n:8,m:8,gnm:.9,hnm:3.9,dgnm:.2,dhnm:.2},{n:9,m:0,gnm:4.6,hnm:0,dgnm:0,dhnm:0},{n:9,m:1,gnm:7.8,hnm:-24.8,dgnm:-.1,dhnm:-.3},{n:9,m:2,gnm:3,hnm:12.2,dgnm:.1,dhnm:.3},{n:9,m:3,gnm:-.2,hnm:8.3,dgnm:.3,dhnm:-.3},{n:9,m:4,gnm:-2.5,hnm:-3.3,dgnm:-.3,dhnm:.3},{n:9,m:5,gnm:-13.1,hnm:-5.2,dgnm:0,dhnm:.2},{n:9,m:6,gnm:2.4,hnm:7.2,dgnm:.3,dhnm:-.1},{n:9,m:7,gnm:8.6,hnm:-.6,dgnm:-.1,dhnm:-.2},{n:9,m:8,gnm:-8.7,hnm:.8,dgnm:.1,dhnm:.4},{n:9,m:9,gnm:-12.9,hnm:10,dgnm:-.1,dhnm:.1},{n:10,m:0,gnm:-1.3,hnm:0,dgnm:.1,dhnm:0},{n:10,m:1,gnm:-6.4,hnm:3.3,dgnm:0,dhnm:0},{n:10,m:2,gnm:.2,hnm:0,dgnm:.1,dhnm:0},{n:10,m:3,gnm:2,hnm:2.4,dgnm:.1,dhnm:-.2},{n:10,m:4,gnm:-1,hnm:5.3,dgnm:0,dhnm:.1},{n:10,m:5,gnm:-.6,hnm:-9.1,dgnm:-.3,dhnm:-.1},{n:10,m:6,gnm:-.9,hnm:.4,dgnm:0,dhnm:.1},{n:10,m:7,gnm:1.5,hnm:-4.2,dgnm:-.1,dhnm:0},{n:10,m:8,gnm:.9,hnm:-3.8,dgnm:-.1,dhnm:-.1},{n:10,m:9,gnm:-2.7,hnm:.9,dgnm:0,dhnm:.2},{n:10,m:10,gnm:-3.9,hnm:-9.1,dgnm:0,dhnm:0},{n:11,m:0,gnm:2.9,hnm:0,dgnm:0,dhnm:0},{n:11,m:1,gnm:-1.5,hnm:0,dgnm:0,dhnm:0},{n:11,m:2,gnm:-2.5,hnm:2.9,dgnm:0,dhnm:.1},{n:11,m:3,gnm:2.4,hnm:-.6,dgnm:0,dhnm:0},{n:11,m:4,gnm:-.6,hnm:.2,dgnm:0,dhnm:.1},{n:11,m:5,gnm:-.1,hnm:.5,dgnm:-.1,dhnm:0},{n:11,m:6,gnm:-.6,hnm:-.3,dgnm:0,dhnm:0},{n:11,m:7,gnm:-.1,hnm:-1.2,dgnm:0,dhnm:.1},{n:11,m:8,gnm:1.1,hnm:-1.7,dgnm:-.1,dhnm:0},{n:11,m:9,gnm:-1,hnm:-2.9,dgnm:-.1,dhnm:0},{n:11,m:10,gnm:-.2,hnm:-1.8,dgnm:-.1,dhnm:0},{n:11,m:11,gnm:2.6,hnm:-2.3,dgnm:-.1,dhnm:0},{n:12,m:0,gnm:-2,hnm:0,dgnm:0,dhnm:0},{n:12,m:1,gnm:-.2,hnm:-1.3,dgnm:0,dhnm:0},{n:12,m:2,gnm:.3,hnm:.7,dgnm:0,dhnm:0},{n:12,m:3,gnm:1.2,hnm:1,dgnm:0,dhnm:-.1},{n:12,m:4,gnm:-1.3,hnm:-1.4,dgnm:0,dhnm:.1},{n:12,m:5,gnm:.6,hnm:0,dgnm:0,dhnm:0},{n:12,m:6,gnm:.6,hnm:.6,dgnm:.1,dhnm:0},{n:12,m:7,gnm:.5,hnm:-.1,dgnm:0,dhnm:0},{n:12,m:8,gnm:-.1,hnm:.8,dgnm:0,dhnm:0},{n:12,m:9,gnm:-.4,hnm:.1,dgnm:0,dhnm:0},{n:12,m:10,gnm:-.2,hnm:-1,dgnm:-.1,dhnm:0},{n:12,m:11,gnm:-1.3,hnm:.1,dgnm:0,dhnm:0},{n:12,m:12,gnm:-.7,hnm:.2,dgnm:-.1,dhnm:-.1}]};R.forEach(n=>{const{n:m,m:t,gnm:e,hnm:o,dgnm:a,dhnm:i}=n;t<=m&&(M[t][m]=e,x[t][m]=a,0!==t&&(M[m][t-1]=o,x[m][t-1]=i))}),E[0][0]=1,C[0]=0;for(let n=1;n<=12;n++){E[0][n]=E[0][n-1]*(2*n-1)/n;let m=2;for(let t=0,e=n-t+1;e>0;e--,t++){if(B[t][n]=((n-1)*(n-1)-t*t)/((2*n-1)*(2*n-3)),t>0){const e=(n-t+1)*m/(n+t);E[t][n]=E[t-1][n]*y(e),m=1,M[n][t-1]=E[t][n]*M[n][t-1],x[n][t-1]=E[t][n]*x[n][t-1]}M[t][n]=E[t][n]*M[t][n],x[t][n]=E[t][n]*x[t][n]}F[n]=n+1,C[n]=n}B[1][1]=0;const V=(n,m)=>{const{latitude:t,longitude:e,altitude:o}=n,a=(n=>{const m=(n=n||new Date).getUTCFullYear(),t=24*(365+(m%400==0||m%4==0&&m%100>0?1:0))*60*60*1e3;return m+(n.valueOf()-Date.UTC(m,0))/t})(m),i=a-z,d=f(t),r=f(e),s=b(r),h=b(d),c=k(r),g=k(d),l=h*h,v=g*g;P[1]=s,L[1]=c;const p=y(I-N*l),w=o*p,E=h/y((w+I)/(w+D)*((w+I)/(w+D))*v+l),W=y(1-E*E),O=y(o*o+2*w+(j-U*l)/(p*p)),R=y(I*v+D*l),V=(o+R)/O,G=N*g*h/(O*R);for(let n=2;n<=12;n++)P[n]=P[1]*L[n-1]+L[1]*P[n-1],L[n]=L[1]*L[n-1]-P[1]*P[n-1];const Y=6371.2/O;let J=Y*Y,K=0,Q=0,X=0,Z=0;for(let n=1;n<=12;n++){J*=Y;for(let m=0,t=n+m+1;t>0;t--,m++){n===m?($[m][n]=W*$[m-1][n-1],A[m][n]=W*A[m-1][n-1]+E*$[m-1][n-1]):1===n&&0===m?($[m][n]=E*$[m][n-1],A[m][n]=E*A[m][n-1]-W*$[m][n-1]):n>1&&n!==m&&(m>n-2&&($[m][n-2]=0),m>n-2&&(A[m][n-2]=0),$[m][n]=E*$[m][n-1]-B[m][n]*$[m][n-2],A[m][n]=E*A[m][n-1]-W*$[m][n-1]-B[m][n]*A[m][n-2]),H[m][n]=M[m][n]+i*x[m][n],0!==m&&(H[n][m-1]=M[n][m-1]+i*x[n][m-1]);const t=J*$[m][n];let e,o;if(0===m?(e=H[m][n]*L[m],o=H[m][n]*P[m]):(e=H[m][n]*L[m]+H[n][m-1]*P[m],o=H[m][n]*P[m]-H[n][m-1]*L[m]),Q-=J*e*A[m][n],X+=C[m]*o*t,K+=F[n]*e*t,0===W&&1===m){q[n]=1===n?q[n-1]:E*q[n-1]-B[m][n]*q[n-2];const t=J*q[n];Z+=C[m]*o*t}}}X=0===W?Z:X/W;const _=-Q*V-K*G,nn=X,mn=Q*G-K*V,tn=y(_*_+nn*nn),en=y(tn*tn+mn*mn),on=u(T(nn,_)),an=u(T(mn,tn));let dn=-999;return S(t)>=55&&(t>0&&e>=0&&(dn=on-e),t>0&&e<0&&(dn=on+S(e)),t<0&&e>=0&&(dn=on+e),t<0&&e<0&&(dn=on-S(e)),dn>180&&(dn-=360),dn<-180&&(dn+=360)),{declination:on,inclination:an,intensity:en,gridVariation:dn}},G=()=>{const n=new Promise((n,m)=>{navigator.geolocation.getCurrentPosition(m=>{const{declination:t}=V(m.coords);m.declination=t,n(m)},()=>n())});return n};var Y=async n=>{if("denied"===(await navigator.permissions.query({name:"geolocation"})).state)return"Permission to use this device's location was denied";let m,t=await G();if(!t)return"Could not get a location for this device";n.location=t;const e=()=>{"visible"===document.visibilityState?m||(m=setInterval(async()=>{t=await G(),t&&(n.location=t)},1e3)):m&&(clearInterval(m),m=void 0)};e(),r(document,"visibilitychange",e)};const J=n=>{const m=p.rad(n);return{"cosθ":Math.cos(m),"sinθ":Math.sin(m)}};var K=n=>{const{"cosθ":m,"sinθ":t}=J(n);return[[1,0,0],[0,m,-t],[0,t,m]]},Q=n=>{const{"cosθ":m,"sinθ":t}=J(n);return[[m,0,t],[0,1,0],[-t,0,m]]},X=n=>{const{"cosθ":m,"sinθ":t}=J(n);return[[m,-t,0],[t,m,0],[0,0,1]]},Z=(...n)=>{let m,t=n[0];for(let e=1;e<n.length;e++){const o=n[e];m=[[],[],[]];for(let n=0;n<3;n++)for(let e=0;e<3;e++)m[n][e]=t[n][0]*o[0][e]+t[n][1]*o[1][e]+t[n][2]*o[2][e];t=m}return m},_=(n,m)=>{const[t,e,o]=m,a=[];for(let m=0;m<3;m++)a[m]=n[m][0]*t+n[m][1]*e+n[m][2]*o;return a},nn=n=>{const[m,t,e]=n[0],[o,a,i]=n[1],[d,r,s]=n[2],h=a*s-i*r,c=-(o*s-i*d),g=o*r-a*d,l=m*h+t*c+e*g;return[[h/l,-(t*s-e*r)/l,(t*i-e*a)/l],[c/l,(m*s-e*d)/l,-(m*i-e*o)/l],[g/l,-(m*r-t*d)/l,(m*a-t*o)/l]]};const{atan2:mn,abs:tn,sign:en,asin:on}=Math,an=.5*Math.PI;var dn=n=>{if(!AbsoluteOrientationSensor)return"Orientation sensor is not supported on this device";const m=new AbsoluteOrientationSensor({frequency:30});m.onreading=()=>{if(!n.location)return;const[t,e,o,a]=m.quaternion,i=u(mn(2*(a*t+e*o),1-2*(t*t+e*e))),d=2*(a*e-o*t);let r=u(tn(d>1)?en(d)*an:on(d));let s=u(mn(2*(a*o+t*e),1-2*(e*e+o*o)));r=360-r,s=v(s-90-n.location.declination),n.rotationMatrix=Z(K(i),Q(r),X(s))},m.start();r(document,"visibilitychange",()=>{"visible"===document.visibilityState?m.start():m.stop()})};const{rad:rn,deg:sn,rev:hn}=p,{cos:cn,sin:gn,atan2:ln}=Math,fn=n=>{let[m,t]=n;m=rn(m),t=rn(t);const e=cn(t);return[cn(m)*e,gn(m)*e,gn(t)]};var un=n=>{const[m,t,e]=n,o=1-e;return[m/o,t/o]},vn=n=>{const[m,t]=n,e=m*m+t*t,o=e+1;return[2*m/o,2*t/o,(e-1)/o]};const pn=(n,m)=>{const{rotationMatrix:t,scale:e}=m,o=.5*n.canvas.clientWidth,a=.5*n.canvas.clientHeight,i=nn(t),d=n=>{const m=_(t,n),[i,d]=un(m);return[i*e+o,d*e+a]},r=n=>{const[m,t]=n,d=vn([(m-o)/e,(t-a)/e]);return _(i,d)};return{polarToScreen:n=>d(fn(n)),rectangularToScreen:d,screenToRectangular:r,screenToPolar:n=>(n=>{const[m,t,e]=n;return[hn(sn(ln(t,m))),sn(ln(e,Math.sqrt(m*m+t*t)))]})(r(n))}},wn=[];for(let n=0;n<360;n+=90){const m=[];for(let t=-90;t<=90;t++)m.push(fn([n,t]));wn.push(m)}for(let n=0;n<360;n+=15)if(n%90>0){const m=[];for(let t=-75;t<=75;t++)m.push(fn([n,t]));wn.push(m)}for(let n=-75;n<=75;n+=15){const m=[];for(let t=0;t<=360;t++)m.push(fn([t,n]));wn.push(m)}const yn=(n,m,t,e,o=[0,0])=>{n.save(),n.translate(...t),n.rotate(e),n.fillText(m,...o),n.restore()},{atan2:bn}=Math,kn=[],Tn=[],Sn=[],Mn=["N","NE","E","SE","S","SW","W","NW"];for(let n=0;n<360;n++)kn.push(fn([n,0]));kn.push(kn[0]);for(let n=0;n<360;n+=45)Tn.push(fn([n,45.5])),Tn.push(fn([n,45])),Sn.push(fn([n,-44.5])),Sn.push(fn([n,-45]));const{atan2:xn,abs:Hn}=Math,{abs:An,cos:En,sin:Pn,tan:Ln,acos:Fn,atan2:Cn,PI:qn}=Math,Bn=1e-9,{sqrt:$n,atan2:Wn,PI:On}=Math,In=.3048,Dn=1609.344,Nn=(n,m)=>{const t=m.marks.filter(n=>n.visible);if(!t.length)return;const{polarToScreen:e}=pn(n,m);n.save(),n.font="bold 16px Arial, Helvetica, sans-serif",n.textAlign="left",n.textBaseline="bottom",n.shadowColor="#000000",t.forEach(t=>{const{coords:o}=m.location;let{distance:a,azimuth:i}=((n,m)=>{const{longitude:t,latitude:e}=n,{longitude:o,latitude:a}=m,i=f(t),d=f(e),r=f(o),s=f(a),h=r-i,c=An(h)<Bn&&An(s-d)<Bn,g=!c&&An(An(h)-qn)<Bn&&An(d+s)<Bn;if(c||g)return{};const l=En(d),p=Pn(d),w=En(s),y=Pn(s),b=Ln(s),k=En(h),T=Pn(h);return{distance:6371008.8*Fn(p*y+l*w*k),azimuth:v(u(Cn(T,l*b-p*k)))}})(o,t);if(a&&a>=20){let m=0;if(void 0!==t.elevation&&a<=5e4){const n=t.elevation-o.altitude;m=u(Wn(n,a)),a=$n(a*a+n*n)}const[d,r]=e([i,m]),[s,h]=e([i+1,m]);n.save(),n.fillStyle="#ff404080",n.strokeStyle="#ffffff",n.shadowBlur=0,n.beginPath(),n.arc(d,r,10,0,2*On),n.fill(),n.stroke();const c=a<Dn?`${(a/In).toFixed(0)} ft`:`${(a/Dn).toFixed(1)} mi`,g=a<1e3?`${a.toFixed(0)} m`:`${(.001*a).toFixed(1)} km`,l=Wn(h-r,s-d);n.fillStyle="#ffffff",n.shadowBlur=5,yn(n,`${t.name} ${c} ${g}`,[d,r],l,[12,0]),n.restore()}})};var jn=n=>{const m=document.querySelector("canvas");m.width=window.innerWidth,m.height=window.innerHeight;const t=m.getContext("2d"),e=1e3/30;let o,a=performance.now();const i=()=>{o=requestAnimationFrame(i);const d=performance.now();d-a<e||(n.rotationMatrix&&(t.clearRect(0,0,m.clientWidth,m.clientHeight),((n,m)=>{const{rectangularToScreen:t}=pn(n,m);n.save(),n.lineWidth=2,n.strokeStyle="#ffffff30",n.shadowBlur=0,wn.forEach(m=>{m=m.map(n=>t(n)),n.beginPath(),n.moveTo(...m[0]);for(let t=1;t<m.length;t++)n.lineTo(...m[t]);n.stroke()}),n.restore()})(t,n),((n,m)=>{const{polarToScreen:t,screenToPolar:e}=pn(n,m),[o]=e([.5*n.canvas.width,.5*n.canvas.height]),a=[];for(let n=-90;n<=90;n++)a.push(t([o,n]));n.save(),n.lineWidth=2,n.strokeStyle="#ffffff30",n.beginPath(),n.moveTo(...a[0]);for(let m=1;m<a.length;m++)n.lineTo(...a[m]);n.stroke(),n.strokeStyle="#ffffffd0",n.fillStyle="#ffffffd0",n.shadowBlur=5,n.shadowColor="#000000",n.font="bold 16px Arial, Helvetica, sans-serif",n.textAlign="left",n.textBaseline="middle";for(let m=-89,t=1;m<=89;m++,t++){const[e,o]=a[t],[i,d]=a[t-1],r=e-i,s=o-d,h=m%5==0,c=h?1:.5;if(n.beginPath(),n.moveTo(e+s*c,o-r*c),n.lineTo(e-s*c,o+r*c),n.stroke(),h&&m){const t=1.5,a=xn(r,-s),i=[e-s*t,o+r*t];yn(n,`${Hn(m)}`,i,a)}}n.restore()})(t,n),((n,m)=>{const{rectangularToScreen:t}=pn(n,m),e=kn.map(t),o=Tn.map(t),a=Sn.map(t);n.save(),n.strokeStyle="#ffffffd0",n.fillStyle="#ffffffd0",n.shadowBlur=5,n.shadowColor="#000000";for(let m=0;m<360;m++){let[t,i]=e[m],[d,r]=e[m+1],s=d-t,h=r-i;const c=m%5==0,g=c?1:.5;if(n.beginPath(),n.moveTo(t+h*g,i-s*g),n.lineTo(t-h*g,i+s*g),n.stroke(),c){n.font="bold 16px Arial, Helvetica, sans-serif",n.textAlign="center",n.textBaseline="top";const e=1.5;let c=bn(h,s),g=[t-h*e,i+s*e];if(yn(n,`${m}`,g,c),m%45==0){n.font="bold 24px Arial, Helvetica, sans-serif",n.textBaseline="bottom";const l=m/45,f=`${Mn[l]}`;g=[t+h*e,i-s*e],yn(n,f,g,c),[t,i]=o[2*l],[d,r]=o[2*l+1],s=d-t,h=r-i,yn(n,f,[t,i],bn(-s,h)),[t,i]=a[2*l],[d,r]=a[2*l+1],s=d-t,h=r-i,yn(n,f,[t,i],bn(-s,h))}}}n.restore()})(t,n),Nn(t,n)),a=d)};i();r(document,"visibilitychange",async()=>{"visible"===document.visibilityState?void 0===o&&(a=performance.now(),i()):void 0!==o&&(cancelAnimationFrame(o),o=void 0)})};var Un=async n=>{if("denied"===(await navigator.permissions.query({name:"screen-wake-lock"})).state)return;let m;const t=async()=>{"visible"===document.visibilityState?m||(m=await navigator.wakeLock.request("screen"),m.addEventListener("release",()=>{m=void 0})):m&&m.release()};await t(),r(document,"visibilitychange",t)};let zn;const Rn=d("mark"),Vn=d("mark-modal"),Gn=d("mark-form"),Yn=d("mark-name"),Jn=d("mark-lat"),Kn=d("mark-lon"),Qn=d("mark-elev"),Xn=d("mark-ok"),Zn=d("mark-cancel");r(Rn,"click",()=>{const{coords:n}=zn.location;Yn.value="",Jn.value=n.latitude.toFixed(6),Kn.value=n.longitude.toFixed(6),Qn.value=n.altitude.toFixed(0),Vn.showModal()}),r(Xn,"click",()=>{if(!Gn.checkValidity())return;const n=Yn.value,m=parseFloat(Jn.value),t=parseFloat(Kn.value),e=Qn.value?parseFloat(Qn.value):void 0,{marks:o}=zn;let a=o.find(m=>m.name.toLowerCase()===n.toLowerCase());a||(a={},o.push(a)),Object.assign(a,{name:n,latitude:m,longitude:t,elevation:e,visible:!0}),Vn.close()}),r(Zn,"click",()=>Vn.close()),r(Vn,"click",n=>{n.target===Vn&&Vn.close()});var _n=n=>{zn=n};(async()=>{const n={scale:1500,marks:[]},m=i("#init")[0];m.style.setProperty("display","block"),m.innerHTML="Starting camera and video ...";let t=await c();t?m.innerHTML=t:(m.innerHTML="Getting device location, please wait ...",t=await Y(n),t?m.innerHTML=t:(t=dn(n),t?m.innerHTML=t:(m.style.setProperty("display","none"),jn(n),Un(),_n(n))))})();
//# sourceMappingURL=index.js.map
