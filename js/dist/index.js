const n=Math.PI/180,m=1/n,e=m=>m*n,t=n=>n*m,d=n=>(n%=360)>=0?n:n+360;var h={rad:e,deg:t,rev:d};const o=(n,m)=>{const e=new Array(n);if(void 0!==m){const t=m instanceof Function;for(let d=0;d<n;d++)e[d]=t?m():m}return e},{sqrt:g,sin:i,cos:r,atan2:a,abs:s}=Math,c=o(13,()=>o(13)),l=o(13,()=>o(13)),f=o(13,()=>o(13)),u=o(13,()=>o(13)),v=o(13,()=>o(13)),p=o(13),w=o(13),y=o(13),T=o(13),M=o(13),b=o(13,()=>o(13)),S=o(13,()=>o(13));p[0]=0,w[0]=1,S[0][0]=1,M[0]=1,u[0][0]=0;const H=6378.137,k=6356.7523142,L=H*H,P=k*k,q=L-P,x=L*L,A=x-P*P;c[0][0]=0,l[0][0]=0;const{epoch:W,model:O}={epoch:2025,model:[{n:1,m:0,gnm:-29351.8,hnm:0,dgnm:12,dhnm:0},{n:1,m:1,gnm:-1410.8,hnm:4545.4,dgnm:9.7,dhnm:-21.5},{n:2,m:0,gnm:-2556.6,hnm:0,dgnm:-11.6,dhnm:0},{n:2,m:1,gnm:2951.1,hnm:-3133.6,dgnm:-5.2,dhnm:-27.7},{n:2,m:2,gnm:1649.3,hnm:-815.1,dgnm:-8,dhnm:-12.1},{n:3,m:0,gnm:1361,hnm:0,dgnm:-1.3,dhnm:0},{n:3,m:1,gnm:-2404.1,hnm:-56.6,dgnm:-4.2,dhnm:4},{n:3,m:2,gnm:1243.8,hnm:237.5,dgnm:.4,dhnm:-.3},{n:3,m:3,gnm:453.6,hnm:-549.5,dgnm:-15.6,dhnm:-4.1},{n:4,m:0,gnm:895,hnm:0,dgnm:-1.6,dhnm:0},{n:4,m:1,gnm:799.5,hnm:278.6,dgnm:-2.4,dhnm:-1.1},{n:4,m:2,gnm:55.7,hnm:-133.9,dgnm:-6,dhnm:4.1},{n:4,m:3,gnm:-281.1,hnm:212,dgnm:5.6,dhnm:1.6},{n:4,m:4,gnm:12.1,hnm:-375.6,dgnm:-7,dhnm:-4.4},{n:5,m:0,gnm:-233.2,hnm:0,dgnm:.6,dhnm:0},{n:5,m:1,gnm:368.9,hnm:45.4,dgnm:1.4,dhnm:-.5},{n:5,m:2,gnm:187.2,hnm:220.2,dgnm:0,dhnm:2.2},{n:5,m:3,gnm:-138.7,hnm:-122.9,dgnm:.6,dhnm:.4},{n:5,m:4,gnm:-142,hnm:43,dgnm:2.2,dhnm:1.7},{n:5,m:5,gnm:20.9,hnm:106.1,dgnm:.9,dhnm:1.9},{n:6,m:0,gnm:64.4,hnm:0,dgnm:-.2,dhnm:0},{n:6,m:1,gnm:63.8,hnm:-18.4,dgnm:-.4,dhnm:.3},{n:6,m:2,gnm:76.9,hnm:16.8,dgnm:.9,dhnm:-1.6},{n:6,m:3,gnm:-115.7,hnm:48.8,dgnm:1.2,dhnm:-.4},{n:6,m:4,gnm:-40.9,hnm:-59.8,dgnm:-.9,dhnm:.9},{n:6,m:5,gnm:14.9,hnm:10.9,dgnm:.3,dhnm:.7},{n:6,m:6,gnm:-60.7,hnm:72.7,dgnm:.9,dhnm:.9},{n:7,m:0,gnm:79.5,hnm:0,dgnm:0,dhnm:0},{n:7,m:1,gnm:-77,hnm:-48.9,dgnm:-.1,dhnm:.6},{n:7,m:2,gnm:-8.8,hnm:-14.4,dgnm:-.1,dhnm:.5},{n:7,m:3,gnm:59.3,hnm:-1,dgnm:.5,dhnm:-.8},{n:7,m:4,gnm:15.8,hnm:23.4,dgnm:-.1,dhnm:0},{n:7,m:5,gnm:2.5,hnm:-7.4,dgnm:-.8,dhnm:-1},{n:7,m:6,gnm:-11.1,hnm:-25.1,dgnm:-.8,dhnm:.6},{n:7,m:7,gnm:14.2,hnm:-2.3,dgnm:.8,dhnm:-.2},{n:8,m:0,gnm:23.2,hnm:0,dgnm:-.1,dhnm:0},{n:8,m:1,gnm:10.8,hnm:7.1,dgnm:.2,dhnm:-.2},{n:8,m:2,gnm:-17.5,hnm:-12.6,dgnm:0,dhnm:.5},{n:8,m:3,gnm:2,hnm:11.4,dgnm:.5,dhnm:-.4},{n:8,m:4,gnm:-21.7,hnm:-9.7,dgnm:-.1,dhnm:.4},{n:8,m:5,gnm:16.9,hnm:12.7,dgnm:.3,dhnm:-.5},{n:8,m:6,gnm:15,hnm:.7,dgnm:.2,dhnm:-.6},{n:8,m:7,gnm:-16.8,hnm:-5.2,dgnm:0,dhnm:.3},{n:8,m:8,gnm:.9,hnm:3.9,dgnm:.2,dhnm:.2},{n:9,m:0,gnm:4.6,hnm:0,dgnm:0,dhnm:0},{n:9,m:1,gnm:7.8,hnm:-24.8,dgnm:-.1,dhnm:-.3},{n:9,m:2,gnm:3,hnm:12.2,dgnm:.1,dhnm:.3},{n:9,m:3,gnm:-.2,hnm:8.3,dgnm:.3,dhnm:-.3},{n:9,m:4,gnm:-2.5,hnm:-3.3,dgnm:-.3,dhnm:.3},{n:9,m:5,gnm:-13.1,hnm:-5.2,dgnm:0,dhnm:.2},{n:9,m:6,gnm:2.4,hnm:7.2,dgnm:.3,dhnm:-.1},{n:9,m:7,gnm:8.6,hnm:-.6,dgnm:-.1,dhnm:-.2},{n:9,m:8,gnm:-8.7,hnm:.8,dgnm:.1,dhnm:.4},{n:9,m:9,gnm:-12.9,hnm:10,dgnm:-.1,dhnm:.1},{n:10,m:0,gnm:-1.3,hnm:0,dgnm:.1,dhnm:0},{n:10,m:1,gnm:-6.4,hnm:3.3,dgnm:0,dhnm:0},{n:10,m:2,gnm:.2,hnm:0,dgnm:.1,dhnm:0},{n:10,m:3,gnm:2,hnm:2.4,dgnm:.1,dhnm:-.2},{n:10,m:4,gnm:-1,hnm:5.3,dgnm:0,dhnm:.1},{n:10,m:5,gnm:-.6,hnm:-9.1,dgnm:-.3,dhnm:-.1},{n:10,m:6,gnm:-.9,hnm:.4,dgnm:0,dhnm:.1},{n:10,m:7,gnm:1.5,hnm:-4.2,dgnm:-.1,dhnm:0},{n:10,m:8,gnm:.9,hnm:-3.8,dgnm:-.1,dhnm:-.1},{n:10,m:9,gnm:-2.7,hnm:.9,dgnm:0,dhnm:.2},{n:10,m:10,gnm:-3.9,hnm:-9.1,dgnm:0,dhnm:0},{n:11,m:0,gnm:2.9,hnm:0,dgnm:0,dhnm:0},{n:11,m:1,gnm:-1.5,hnm:0,dgnm:0,dhnm:0},{n:11,m:2,gnm:-2.5,hnm:2.9,dgnm:0,dhnm:.1},{n:11,m:3,gnm:2.4,hnm:-.6,dgnm:0,dhnm:0},{n:11,m:4,gnm:-.6,hnm:.2,dgnm:0,dhnm:.1},{n:11,m:5,gnm:-.1,hnm:.5,dgnm:-.1,dhnm:0},{n:11,m:6,gnm:-.6,hnm:-.3,dgnm:0,dhnm:0},{n:11,m:7,gnm:-.1,hnm:-1.2,dgnm:0,dhnm:.1},{n:11,m:8,gnm:1.1,hnm:-1.7,dgnm:-.1,dhnm:0},{n:11,m:9,gnm:-1,hnm:-2.9,dgnm:-.1,dhnm:0},{n:11,m:10,gnm:-.2,hnm:-1.8,dgnm:-.1,dhnm:0},{n:11,m:11,gnm:2.6,hnm:-2.3,dgnm:-.1,dhnm:0},{n:12,m:0,gnm:-2,hnm:0,dgnm:0,dhnm:0},{n:12,m:1,gnm:-.2,hnm:-1.3,dgnm:0,dhnm:0},{n:12,m:2,gnm:.3,hnm:.7,dgnm:0,dhnm:0},{n:12,m:3,gnm:1.2,hnm:1,dgnm:0,dhnm:-.1},{n:12,m:4,gnm:-1.3,hnm:-1.4,dgnm:0,dhnm:.1},{n:12,m:5,gnm:.6,hnm:0,dgnm:0,dhnm:0},{n:12,m:6,gnm:.6,hnm:.6,dgnm:.1,dhnm:0},{n:12,m:7,gnm:.5,hnm:-.1,dgnm:0,dhnm:0},{n:12,m:8,gnm:-.1,hnm:.8,dgnm:0,dhnm:0},{n:12,m:9,gnm:-.4,hnm:.1,dgnm:0,dhnm:0},{n:12,m:10,gnm:-.2,hnm:-1,dgnm:-.1,dhnm:0},{n:12,m:11,gnm:-1.3,hnm:.1,dgnm:0,dhnm:0},{n:12,m:12,gnm:-.7,hnm:.2,dgnm:-.1,dhnm:-.1}]};O.forEach(n=>{const{n:m,m:e,gnm:t,hnm:d,dgnm:h,dhnm:o}=n;e<=m&&(c[e][m]=t,l[e][m]=h,0!==e&&(c[m][e-1]=d,l[m][e-1]=o))}),v[0][0]=1,T[0]=0;for(let n=1;n<=12;n++){v[0][n]=v[0][n-1]*(2*n-1)/n;let m=2;for(let e=0,t=n-e+1;t>0;t--,e++){if(b[e][n]=((n-1)*(n-1)-e*e)/((2*n-1)*(2*n-3)),e>0){const t=(n-e+1)*m/(n+e);v[e][n]=v[e-1][n]*g(t),m=1,c[n][e-1]=v[e][n]*c[n][e-1],l[n][e-1]=v[e][n]*l[n][e-1]}c[e][n]=v[e][n]*c[e][n],l[e][n]=v[e][n]*l[e][n]}y[n]=n+1,T[n]=n}b[1][1]=0;const C=(n,m)=>{const{latitude:d,longitude:h,altitude:o}=n,v=(n=>{const m=(n=n||new Date).getUTCFullYear(),e=24*(365+(m%400==0||m%4==0&&m%100>0?1:0))*60*60*1e3;return m+(n.valueOf()-Date.UTC(m,0))/e})(m),H=v-W,k=e(d),O=e(h),C=i(O),E=i(k),B=r(O),N=r(k),U=E*E,D=N*N;p[1]=C,w[1]=B;const R=g(L-q*U),j=o*R,F=E/g((j+L)/(j+P)*((j+L)/(j+P))*D+U),I=g(1-F*F),$=g(o*o+2*j+(x-A*U)/(R*R)),V=g(L*D+P*U),Y=(o+V)/$,z=q*N*E/($*V);for(let n=2;n<=12;n++)p[n]=p[1]*w[n-1]+w[1]*p[n-1],w[n]=w[1]*w[n-1]-p[1]*p[n-1];const G=6371.2/$;let J=G*G,K=0,Q=0,X=0,Z=0;for(let n=1;n<=12;n++){J*=G;for(let m=0,e=n+m+1;e>0;e--,m++){n===m?(S[m][n]=I*S[m-1][n-1],u[m][n]=I*u[m-1][n-1]+F*S[m-1][n-1]):1===n&&0===m?(S[m][n]=F*S[m][n-1],u[m][n]=F*u[m][n-1]-I*S[m][n-1]):n>1&&n!==m&&(m>n-2&&(S[m][n-2]=0),m>n-2&&(u[m][n-2]=0),S[m][n]=F*S[m][n-1]-b[m][n]*S[m][n-2],u[m][n]=F*u[m][n-1]-I*S[m][n-1]-b[m][n]*u[m][n-2]),f[m][n]=c[m][n]+H*l[m][n],0!==m&&(f[n][m-1]=c[n][m-1]+H*l[n][m-1]);const e=J*S[m][n];let t,d;if(0===m?(t=f[m][n]*w[m],d=f[m][n]*p[m]):(t=f[m][n]*w[m]+f[n][m-1]*p[m],d=f[m][n]*p[m]-f[n][m-1]*w[m]),Q-=J*t*u[m][n],X+=T[m]*d*e,K+=y[n]*t*e,0===I&&1===m){M[n]=1===n?M[n-1]:F*M[n-1]-b[m][n]*M[n-2];const e=J*M[n];Z+=T[m]*d*e}}}X=0===I?Z:X/I;const _=-Q*Y-K*z,nn=X,mn=Q*z-K*Y,en=g(_*_+nn*nn),tn=g(en*en+mn*mn),dn=t(a(nn,_)),hn=t(a(mn,en));let on=-999;return s(d)>=55&&(d>0&&h>=0&&(on=dn-h),d>0&&h<0&&(on=dn+s(h)),d<0&&h>=0&&(on=dn+h),d<0&&h<0&&(on=dn-s(h)),on>180&&(on-=360),on<-180&&(on+=360)),{declination:dn,inclination:hn,intensity:tn,gridVariation:on}},E=()=>new Promise((n,m)=>{navigator.geolocation.getCurrentPosition((e,t)=>{if(t)m(t);else{const{declination:m}=C(e.coords);e.declination=m,n(e)}})}),B=n=>{const m=h.rad(n);return{"cosθ":Math.cos(m),"sinθ":Math.sin(m)}};var N=n=>{const{"cosθ":m,"sinθ":e}=B(n);return[[1,0,0],[0,m,-e],[0,e,m]]},U=n=>{const{"cosθ":m,"sinθ":e}=B(n);return[[m,0,e],[0,1,0],[-e,0,m]]},D=n=>{const{"cosθ":m,"sinθ":e}=B(n);return[[m,-e,0],[e,m,0],[0,0,1]]},R=(...n)=>{let m,e=n[0];for(let t=1;t<n.length;t++){const d=n[t];m=[[],[],[]];for(let n=0;n<3;n++)for(let t=0;t<3;t++)m[n][t]=e[n][0]*d[0][t]+e[n][1]*d[1][t]+e[n][2]*d[2][t];e=m}return m},j=(n,m)=>{const[e,t,d]=m,h=[];for(let m=0;m<3;m++)h[m]=n[m][0]*e+n[m][1]*t+n[m][2]*d;return h},F=n=>{const[m,e,t]=n[0],[d,h,o]=n[1],[g,i,r]=n[2],a=h*r-o*i,s=-(d*r-o*g),c=d*i-h*g,l=m*a+e*s+t*c;return[[a/l,-(e*r-t*i)/l,(e*o-t*h)/l],[s/l,(m*r-t*g)/l,-(m*o-t*d)/l],[c/l,-(m*i-e*g)/l,(m*h-e*d)/l]]};const{rad:I,deg:$,rev:V}=h,{cos:Y,sin:z,atan2:G}=Math,J=n=>{let[m,e]=n;m=I(m),e=I(e);const t=Y(e);return[Y(m)*t,z(m)*t,z(e)]};var K=n=>{const[m,e,t]=n,d=1-t;return[m/d,e/d]},Q=n=>{const[m,e]=n,t=m*m+e*e,d=t+1;return[2*m/d,2*e/d,(t-1)/d]};const X=(n,m,e)=>{const t=.5*n.canvas.clientWidth,d=.5*n.canvas.clientHeight,h=F(m),o=n=>{const h=j(m,n),[o,g]=K(h);return[o*e+t,g*e+d]},g=n=>{const[m,o]=n,g=Q([(m-t)/e,(o-d)/e]);return j(h,g)};return{polarToScreen:n=>o(J(n)),rectangularToScreen:o,screenToRectangular:g,screenToPolar:n=>(n=>{const[m,e,t]=n;return[V($(G(e,m))),$(G(t,Math.sqrt(m*m+e*e)))]})(g(n))}},Z=[];for(let n=0;n<360;n+=90){const m=[];for(let e=-90;e<=90;e++)m.push(J([n,e]));Z.push(m)}for(let n=0;n<360;n+=15)if(n%90>0){const m=[];for(let e=-75;e<=75;e++)m.push(J([n,e]));Z.push(m)}for(let n=-75;n<=75;n+=15){const m=[];for(let e=0;e<=360;e++)m.push(J([e,n]));Z.push(m)}const _=(n,m,e,t)=>{n.save(),n.translate(...e),n.rotate(t),n.fillText(m,0,0),n.restore()},{atan2:nn}=Math,mn=[],en=[],tn=[],dn=["N","NE","E","SE","S","SW","W","NW"];for(let n=0;n<360;n++)mn.push(J([n,0]));mn.push(mn[0]);for(let n=0;n<360;n+=45)en.push(J([n,45.5])),en.push(J([n,45])),tn.push(J([n,-44.5])),tn.push(J([n,-45]));const{atan2:hn,abs:on}=Math;(async()=>{const n=document.querySelector("#init");if(n.style.setProperty("display","block"),n.innerHTML="Starting camera and video...",!navigator.mediaDevices)return void(n.innerHTML="No camera available");let m=await navigator.permissions.query({name:"camera"});if("denied"===m.state)return void(n.innerHTML="Permission to use this device's camera was denied");const e={video:{facingMode:{exact:"environment"},width:{ideal:window.innerHeight},height:{ideal:window.innerWidth}}};let h;try{h=await navigator.mediaDevices.getUserMedia(e)}catch{return void(n.innerHTML="No front-facing camera available")}const o=document.querySelector("video");if("srcObject"in o?o.srcObject=h:o.src=URL.createObjectURL(h),m=await navigator.permissions.query({name:"geolocation"}),"denied"===m.state)return void(n.innerHTML="Permission to use this device's location was denied");let g;n.innerHTML="Obtaining device location, please wait ...";try{g=await E()}catch(m){return void(1===m.code?n.innerHTML="Permission to use this device's location was denied":n.innerHTML="Could not obtain a location for this device")}setInterval(async()=>{g=await E()},1e3);const i=.5*Math.PI;if(!AbsoluteOrientationSensor)return void(n.innerHTML="Orientation sensor is not supported on this device");let r;const a=new AbsoluteOrientationSensor({frequency:30});a.onreading=()=>{const[n,m,e,h]=a.quaternion,o=2*(h*n+m*e),s=1-2*(n*n+m*m),c=t(Math.atan2(o,s)),l=2*(h*m-e*n);let f=t(Math.abs(l>1)?Math.sign(l)*i:Math.asin(l));const u=2*(h*e+n*m),v=1-2*(m*m+e*e);let p=t(Math.atan2(u,v));f=360-f,p=d(p-90-g.declination),r=R(N(c),U(f),D(p))},a.start(),n.style.setProperty("display","none");const s=document.querySelector("canvas");s.width=window.innerWidth,s.height=window.innerHeight;const c=s.getContext("2d");let l=1500;const f=()=>{r&&(c.clearRect(0,0,s.clientWidth,s.clientHeight),((n,m,e)=>{const{rectangularToScreen:t}=X(n,m,e);n.lineWidth=2,n.strokeStyle="#ffffff30",n.shadowBlur=0,Z.forEach(m=>{m=m.map(n=>t(n)),n.beginPath(),n.moveTo(...m[0]);for(let e=1;e<m.length;e++)n.lineTo(...m[e]);n.stroke()})})(c,r,l),((n,m,e)=>{const{polarToScreen:t,screenToPolar:d}=X(n,m,e),[h]=d([.5*n.canvas.width,.5*n.canvas.height]),o=[];for(let n=-89;n<=89;n++)o.push(t([h,n]));n.shadowBlur=5,n.shadowColor="#000000",n.lineWidth=2,n.strokeStyle="#ffffff30",n.beginPath(),n.moveTo(...o[0]);for(let m=1;m<o.length;m++)n.lineTo(...o[m]);n.stroke(),n.strokeStyle="#ffffffd0",n.fillStyle="#ffffffd0",n.font="bold 16px Arial, Helvetica, sans-serif",n.textAlign="left",n.textBaseline="middle",o.unshift(t([h,-90]));for(let m=-89,e=1;m<=89;m++,e++){const[t,d]=o[e],[h,g]=o[e-1],i=t-h,r=d-g,a=m%5==0,s=a?1:.5;if(n.beginPath(),n.moveTo(t+r*s,d-i*s),n.lineTo(t-r*s,d+i*s),n.stroke(),a&&m){const e=1.5,h=hn(i,-r),o=[t-r*e,d+i*e];_(n,`${on(m)}`,o,h)}}})(c,r,l),((n,m,e)=>{const{rectangularToScreen:t}=X(n,m,e),d=mn.map(t),h=en.map(t),o=tn.map(t);n.strokeStyle="#ffffffd0",n.fillStyle="#ffffffd0",n.shadowBlur=5,n.shadowColor="#000000";for(let m=0;m<360;m++){let[e,t]=d[m],[g,i]=d[m+1],r=g-e,a=i-t;const s=m%5==0,c=s?1:.5;if(n.beginPath(),n.moveTo(e+a*c,t-r*c),n.lineTo(e-a*c,t+r*c),n.stroke(),s){n.font="bold 16px Arial, Helvetica, sans-serif",n.textAlign="center",n.textBaseline="top";const d=1.5;let s=nn(a,r),c=[e-a*d,t+r*d];if(_(n,`${m}`,c,s),m%45==0){n.font="bold 24px Arial, Helvetica, sans-serif",n.textBaseline="bottom";const l=m/45,f=`${dn[l]}`;c=[e+a*d,t-r*d],_(n,f,c,s),[e,t]=h[2*l],[g,i]=h[2*l+1],r=g-e,a=i-t,_(n,f,[e,t],nn(-r,a)),[e,t]=o[2*l],[g,i]=o[2*l+1],r=g-e,a=i-t,_(n,f,[e,t],nn(-r,a))}}}})(c,r,l)),requestAnimationFrame(f)};if(f(),m=await navigator.permissions.query({name:"screen-wake-lock"}),"denied"!==m.state){let n=await navigator.wakeLock.request("screen");document.addEventListener("visibilitychange",async()=>{"visible"===document.visibilityState?n||(n=await navigator.wakeLock.request("screen"),n.addEventListener("release",()=>{n=void 0})):n&&n.release()})}})();
//# sourceMappingURL=index.js.map
