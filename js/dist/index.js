const n="localhost"===new URL(document.location.href).hostname?"development":"production",e=n=>n instanceof Array?n:n instanceof HTMLElement||n instanceof HTMLDocument?[n]:n instanceof HTMLCollection?Array.from(n):void 0,t=(n,t)=>{const m=e(t);if(!m)throw new Error("invalid child elements");m.forEach(e=>n.appendChild(e))},m=(n,t)=>{const m=e(n);if(!m)throw new Error("invalid target");m.forEach(n=>t(n))},o=n=>"String"===n.constructor.name||n instanceof Array||n instanceof HTMLElement||n instanceof HTMLCollection;var i=t,a=(n,...e)=>{const m=document.createElement(n),i=e.find(n=>!o(n));i&&Object.assign(m,i);const a=e.find(o);return a&&("String"===a.constructor.name?m.innerHTML=a:t(m,a)),m},s=(...n)=>{const e=n.pop(),t=n.length?n[0]:document;return Array.from(t.querySelectorAll(e))},d=n=>document.getElementById(n),r=(n,e,t)=>m(n,n=>n.addEventListener(e,t));const l={video:{facingMode:{exact:"environment"},width:{ideal:window.innerHeight},height:{ideal:window.innerWidth}}},c=async()=>{let n;try{n=await navigator.mediaDevices.getUserMedia(l)}catch{}return n};var h=async()=>{if(!navigator.mediaDevices)return"No camera available";if("denied"===(await navigator.permissions.query({name:"camera"})).state)return"Permission to use this device's camera was denied";let n=await c();if(!n)return"No front-facing camera available";const e=d("video-container");let t;const m=async()=>{"visible"===document.visibilityState?t||(n||(n=await c()),t=a("video",{autoplay:!0,mute:!0}),i(e,t),t.srcObject=n):t&&(t.srcObject.getTracks().forEach(n=>n.stop()),t.remove(),t=void 0,n=void 0)};await m(),r(document,"visibilitychange",m)};const g=Math.PI/180,u=1/g,f=n=>n*g,v=n=>n*u,y=n=>(n%=360)>=0?n:n+360;var w={rad:f,deg:v,rev:y};const p=(n,e)=>{const t=new Array(n);return void 0!==e&&t.fill(e instanceof Function?e():e),t},{sqrt:b,sin:k,cos:M,atan2:T,abs:S}=Math,x=p(13,()=>p(13)),P=p(13,()=>p(13)),H=p(13,()=>p(13)),E=p(13,()=>p(13)),A=p(13,()=>p(13)),L=p(13),F=p(13),q=p(13),I=p(13),B=p(13),C=p(13,()=>p(13)),$=p(13,()=>p(13));L[0]=0,F[0]=1,$[0][0]=1,B[0]=1,E[0][0]=0;const N=6378.137,W=6356.7523142,D=N*N,O=W*W,j=D-O,U=D*D,R=U-O*O;x[0][0]=0,P[0][0]=0;const{epoch:z,model:V}={epoch:2025,model:[{n:1,m:0,gnm:-29351.8,hnm:0,dgnm:12,dhnm:0},{n:1,m:1,gnm:-1410.8,hnm:4545.4,dgnm:9.7,dhnm:-21.5},{n:2,m:0,gnm:-2556.6,hnm:0,dgnm:-11.6,dhnm:0},{n:2,m:1,gnm:2951.1,hnm:-3133.6,dgnm:-5.2,dhnm:-27.7},{n:2,m:2,gnm:1649.3,hnm:-815.1,dgnm:-8,dhnm:-12.1},{n:3,m:0,gnm:1361,hnm:0,dgnm:-1.3,dhnm:0},{n:3,m:1,gnm:-2404.1,hnm:-56.6,dgnm:-4.2,dhnm:4},{n:3,m:2,gnm:1243.8,hnm:237.5,dgnm:.4,dhnm:-.3},{n:3,m:3,gnm:453.6,hnm:-549.5,dgnm:-15.6,dhnm:-4.1},{n:4,m:0,gnm:895,hnm:0,dgnm:-1.6,dhnm:0},{n:4,m:1,gnm:799.5,hnm:278.6,dgnm:-2.4,dhnm:-1.1},{n:4,m:2,gnm:55.7,hnm:-133.9,dgnm:-6,dhnm:4.1},{n:4,m:3,gnm:-281.1,hnm:212,dgnm:5.6,dhnm:1.6},{n:4,m:4,gnm:12.1,hnm:-375.6,dgnm:-7,dhnm:-4.4},{n:5,m:0,gnm:-233.2,hnm:0,dgnm:.6,dhnm:0},{n:5,m:1,gnm:368.9,hnm:45.4,dgnm:1.4,dhnm:-.5},{n:5,m:2,gnm:187.2,hnm:220.2,dgnm:0,dhnm:2.2},{n:5,m:3,gnm:-138.7,hnm:-122.9,dgnm:.6,dhnm:.4},{n:5,m:4,gnm:-142,hnm:43,dgnm:2.2,dhnm:1.7},{n:5,m:5,gnm:20.9,hnm:106.1,dgnm:.9,dhnm:1.9},{n:6,m:0,gnm:64.4,hnm:0,dgnm:-.2,dhnm:0},{n:6,m:1,gnm:63.8,hnm:-18.4,dgnm:-.4,dhnm:.3},{n:6,m:2,gnm:76.9,hnm:16.8,dgnm:.9,dhnm:-1.6},{n:6,m:3,gnm:-115.7,hnm:48.8,dgnm:1.2,dhnm:-.4},{n:6,m:4,gnm:-40.9,hnm:-59.8,dgnm:-.9,dhnm:.9},{n:6,m:5,gnm:14.9,hnm:10.9,dgnm:.3,dhnm:.7},{n:6,m:6,gnm:-60.7,hnm:72.7,dgnm:.9,dhnm:.9},{n:7,m:0,gnm:79.5,hnm:0,dgnm:0,dhnm:0},{n:7,m:1,gnm:-77,hnm:-48.9,dgnm:-.1,dhnm:.6},{n:7,m:2,gnm:-8.8,hnm:-14.4,dgnm:-.1,dhnm:.5},{n:7,m:3,gnm:59.3,hnm:-1,dgnm:.5,dhnm:-.8},{n:7,m:4,gnm:15.8,hnm:23.4,dgnm:-.1,dhnm:0},{n:7,m:5,gnm:2.5,hnm:-7.4,dgnm:-.8,dhnm:-1},{n:7,m:6,gnm:-11.1,hnm:-25.1,dgnm:-.8,dhnm:.6},{n:7,m:7,gnm:14.2,hnm:-2.3,dgnm:.8,dhnm:-.2},{n:8,m:0,gnm:23.2,hnm:0,dgnm:-.1,dhnm:0},{n:8,m:1,gnm:10.8,hnm:7.1,dgnm:.2,dhnm:-.2},{n:8,m:2,gnm:-17.5,hnm:-12.6,dgnm:0,dhnm:.5},{n:8,m:3,gnm:2,hnm:11.4,dgnm:.5,dhnm:-.4},{n:8,m:4,gnm:-21.7,hnm:-9.7,dgnm:-.1,dhnm:.4},{n:8,m:5,gnm:16.9,hnm:12.7,dgnm:.3,dhnm:-.5},{n:8,m:6,gnm:15,hnm:.7,dgnm:.2,dhnm:-.6},{n:8,m:7,gnm:-16.8,hnm:-5.2,dgnm:0,dhnm:.3},{n:8,m:8,gnm:.9,hnm:3.9,dgnm:.2,dhnm:.2},{n:9,m:0,gnm:4.6,hnm:0,dgnm:0,dhnm:0},{n:9,m:1,gnm:7.8,hnm:-24.8,dgnm:-.1,dhnm:-.3},{n:9,m:2,gnm:3,hnm:12.2,dgnm:.1,dhnm:.3},{n:9,m:3,gnm:-.2,hnm:8.3,dgnm:.3,dhnm:-.3},{n:9,m:4,gnm:-2.5,hnm:-3.3,dgnm:-.3,dhnm:.3},{n:9,m:5,gnm:-13.1,hnm:-5.2,dgnm:0,dhnm:.2},{n:9,m:6,gnm:2.4,hnm:7.2,dgnm:.3,dhnm:-.1},{n:9,m:7,gnm:8.6,hnm:-.6,dgnm:-.1,dhnm:-.2},{n:9,m:8,gnm:-8.7,hnm:.8,dgnm:.1,dhnm:.4},{n:9,m:9,gnm:-12.9,hnm:10,dgnm:-.1,dhnm:.1},{n:10,m:0,gnm:-1.3,hnm:0,dgnm:.1,dhnm:0},{n:10,m:1,gnm:-6.4,hnm:3.3,dgnm:0,dhnm:0},{n:10,m:2,gnm:.2,hnm:0,dgnm:.1,dhnm:0},{n:10,m:3,gnm:2,hnm:2.4,dgnm:.1,dhnm:-.2},{n:10,m:4,gnm:-1,hnm:5.3,dgnm:0,dhnm:.1},{n:10,m:5,gnm:-.6,hnm:-9.1,dgnm:-.3,dhnm:-.1},{n:10,m:6,gnm:-.9,hnm:.4,dgnm:0,dhnm:.1},{n:10,m:7,gnm:1.5,hnm:-4.2,dgnm:-.1,dhnm:0},{n:10,m:8,gnm:.9,hnm:-3.8,dgnm:-.1,dhnm:-.1},{n:10,m:9,gnm:-2.7,hnm:.9,dgnm:0,dhnm:.2},{n:10,m:10,gnm:-3.9,hnm:-9.1,dgnm:0,dhnm:0},{n:11,m:0,gnm:2.9,hnm:0,dgnm:0,dhnm:0},{n:11,m:1,gnm:-1.5,hnm:0,dgnm:0,dhnm:0},{n:11,m:2,gnm:-2.5,hnm:2.9,dgnm:0,dhnm:.1},{n:11,m:3,gnm:2.4,hnm:-.6,dgnm:0,dhnm:0},{n:11,m:4,gnm:-.6,hnm:.2,dgnm:0,dhnm:.1},{n:11,m:5,gnm:-.1,hnm:.5,dgnm:-.1,dhnm:0},{n:11,m:6,gnm:-.6,hnm:-.3,dgnm:0,dhnm:0},{n:11,m:7,gnm:-.1,hnm:-1.2,dgnm:0,dhnm:.1},{n:11,m:8,gnm:1.1,hnm:-1.7,dgnm:-.1,dhnm:0},{n:11,m:9,gnm:-1,hnm:-2.9,dgnm:-.1,dhnm:0},{n:11,m:10,gnm:-.2,hnm:-1.8,dgnm:-.1,dhnm:0},{n:11,m:11,gnm:2.6,hnm:-2.3,dgnm:-.1,dhnm:0},{n:12,m:0,gnm:-2,hnm:0,dgnm:0,dhnm:0},{n:12,m:1,gnm:-.2,hnm:-1.3,dgnm:0,dhnm:0},{n:12,m:2,gnm:.3,hnm:.7,dgnm:0,dhnm:0},{n:12,m:3,gnm:1.2,hnm:1,dgnm:0,dhnm:-.1},{n:12,m:4,gnm:-1.3,hnm:-1.4,dgnm:0,dhnm:.1},{n:12,m:5,gnm:.6,hnm:0,dgnm:0,dhnm:0},{n:12,m:6,gnm:.6,hnm:.6,dgnm:.1,dhnm:0},{n:12,m:7,gnm:.5,hnm:-.1,dgnm:0,dhnm:0},{n:12,m:8,gnm:-.1,hnm:.8,dgnm:0,dhnm:0},{n:12,m:9,gnm:-.4,hnm:.1,dgnm:0,dhnm:0},{n:12,m:10,gnm:-.2,hnm:-1,dgnm:-.1,dhnm:0},{n:12,m:11,gnm:-1.3,hnm:.1,dgnm:0,dhnm:0},{n:12,m:12,gnm:-.7,hnm:.2,dgnm:-.1,dhnm:-.1}]};V.forEach(n=>{const{n:e,m:t,gnm:m,hnm:o,dgnm:i,dhnm:a}=n;t<=e&&(x[t][e]=m,P[t][e]=i,0!==t&&(x[e][t-1]=o,P[e][t-1]=a))}),A[0][0]=1,I[0]=0;for(let n=1;n<=12;n++){A[0][n]=A[0][n-1]*(2*n-1)/n;let e=2;for(let t=0,m=n-t+1;m>0;m--,t++){if(C[t][n]=((n-1)*(n-1)-t*t)/((2*n-1)*(2*n-3)),t>0){const m=(n-t+1)*e/(n+t);A[t][n]=A[t-1][n]*b(m),e=1,x[n][t-1]=A[t][n]*x[n][t-1],P[n][t-1]=A[t][n]*P[n][t-1]}x[t][n]=A[t][n]*x[t][n],P[t][n]=A[t][n]*P[t][n]}q[n]=n+1,I[n]=n}C[1][1]=0;const G=(n,e)=>{const{latitude:t,longitude:m,altitude:o}=n,i=(n=>{const e=(n=n||new Date).getUTCFullYear(),t=24*(365+(e%400==0||e%4==0&&e%100>0?1:0))*60*60*1e3;return e+(n.valueOf()-Date.UTC(e,0))/t})(e),a=i-z,s=f(t),d=f(m),r=k(d),l=k(s),c=M(d),h=M(s),g=l*l,u=h*h;L[1]=r,F[1]=c;const y=b(D-j*g),w=o*y,p=l/b((w+D)/(w+O)*((w+D)/(w+O))*u+g),A=b(1-p*p),N=b(o*o+2*w+(U-R*g)/(y*y)),W=b(D*u+O*g),V=(o+W)/N,G=j*h*l/(N*W);for(let n=2;n<=12;n++)L[n]=L[1]*F[n-1]+F[1]*L[n-1],F[n]=F[1]*F[n-1]-L[1]*L[n-1];const Y=6371.2/N;let J=Y*Y,K=0,Q=0,X=0,Z=0;for(let n=1;n<=12;n++){J*=Y;for(let e=0,t=n+e+1;t>0;t--,e++){n===e?($[e][n]=A*$[e-1][n-1],E[e][n]=A*E[e-1][n-1]+p*$[e-1][n-1]):1===n&&0===e?($[e][n]=p*$[e][n-1],E[e][n]=p*E[e][n-1]-A*$[e][n-1]):n>1&&n!==e&&(e>n-2&&($[e][n-2]=0),e>n-2&&(E[e][n-2]=0),$[e][n]=p*$[e][n-1]-C[e][n]*$[e][n-2],E[e][n]=p*E[e][n-1]-A*$[e][n-1]-C[e][n]*E[e][n-2]),H[e][n]=x[e][n]+a*P[e][n],0!==e&&(H[n][e-1]=x[n][e-1]+a*P[n][e-1]);const t=J*$[e][n];let m,o;if(0===e?(m=H[e][n]*F[e],o=H[e][n]*L[e]):(m=H[e][n]*F[e]+H[n][e-1]*L[e],o=H[e][n]*L[e]-H[n][e-1]*F[e]),Q-=J*m*E[e][n],X+=I[e]*o*t,K+=q[n]*m*t,0===A&&1===e){B[n]=1===n?B[n-1]:p*B[n-1]-C[e][n]*B[n-2];const t=J*B[n];Z+=I[e]*o*t}}}X=0===A?Z:X/A;const _=-Q*V-K*G,nn=X,en=Q*G-K*V,tn=b(_*_+nn*nn),mn=b(tn*tn+en*en),on=v(T(nn,_)),an=v(T(en,tn));let sn=-999;return S(t)>=55&&(t>0&&m>=0&&(sn=on-m),t>0&&m<0&&(sn=on+S(m)),t<0&&m>=0&&(sn=on+m),t<0&&m<0&&(sn=on-S(m)),sn>180&&(sn-=360),sn<-180&&(sn+=360)),{declination:on,inclination:an,intensity:mn,gridVariation:sn}},Y=()=>{const n=new Promise((n,e)=>{navigator.geolocation.getCurrentPosition(e=>{const{declination:t}=G(e.coords);e.declination=t,n(e)},()=>n())});return n};var J=async n=>{if("denied"===(await navigator.permissions.query({name:"geolocation"})).state)return"Permission to use this device's location was denied";let e,t=await Y();if(!t)return"Could not get a location for this device";n.location=t;const m=()=>{"visible"===document.visibilityState?e||(e=setInterval(async()=>{t=await Y(),t&&(n.location=t)},1e3)):e&&(clearInterval(e),e=void 0)};m(),r(document,"visibilitychange",m)};const K=n=>{const e=w.rad(n);return{"cosθ":Math.cos(e),"sinθ":Math.sin(e)}};var Q=n=>{const{"cosθ":e,"sinθ":t}=K(n);return[[1,0,0],[0,e,-t],[0,t,e]]},X=n=>{const{"cosθ":e,"sinθ":t}=K(n);return[[e,0,t],[0,1,0],[-t,0,e]]},Z=n=>{const{"cosθ":e,"sinθ":t}=K(n);return[[e,-t,0],[t,e,0],[0,0,1]]},_=(...n)=>{let e,t=n[0];for(let m=1;m<n.length;m++){const o=n[m];e=[[],[],[]];for(let n=0;n<3;n++)for(let m=0;m<3;m++)e[n][m]=t[n][0]*o[0][m]+t[n][1]*o[1][m]+t[n][2]*o[2][m];t=e}return e},nn=(n,e)=>{const[t,m,o]=e,i=[];for(let e=0;e<3;e++)i[e]=n[e][0]*t+n[e][1]*m+n[e][2]*o;return i},en=n=>{const[e,t,m]=n[0],[o,i,a]=n[1],[s,d,r]=n[2],l=i*r-a*d,c=-(o*r-a*s),h=o*d-i*s,g=e*l+t*c+m*h;return[[l/g,-(t*r-m*d)/g,(t*a-m*i)/g],[c/g,(e*r-m*s)/g,-(e*a-m*o)/g],[h/g,-(e*d-t*s)/g,(e*i-t*o)/g]]};const{atan2:tn,abs:mn,sign:on,asin:an}=Math,sn=.5*Math.PI;var dn=n=>{if(!AbsoluteOrientationSensor)return"Orientation sensor is not supported on this device";const e=new AbsoluteOrientationSensor({frequency:30});e.onreading=()=>{if(!n.location)return;const[t,m,o,i]=e.quaternion,a=v(tn(2*(i*t+m*o),1-2*(t*t+m*m))),s=2*(i*m-o*t);let d=v(mn(s>1)?on(s)*sn:an(s));let r=v(tn(2*(i*o+t*m),1-2*(m*m+o*o)));d=360-d,r=y(r-90-n.location.declination),n.rotationMatrix=_(Q(a),X(d),Z(r))},e.start();r(document,"visibilitychange",()=>{"visible"===document.visibilityState?e.start():e.stop()})};const{rad:rn,deg:ln,rev:cn}=w,{cos:hn,sin:gn,atan2:un}=Math,fn=n=>{let[e,t]=n;e=rn(e),t=rn(t);const m=hn(t);return[hn(e)*m,gn(e)*m,gn(t)]};var vn=n=>{const[e,t,m]=n,o=1-m;return[e/o,t/o]},yn=n=>{const[e,t]=n,m=e*e+t*t,o=m+1;return[2*e/o,2*t/o,(m-1)/o]};const wn=(n,e)=>{const{rotationMatrix:t,scale:m}=e,o=.5*n.canvas.clientWidth,i=.5*n.canvas.clientHeight,a=en(t),s=n=>{const e=nn(t,n),[a,s]=vn(e);return[a*m+o,s*m+i]},d=n=>{const[e,t]=n,s=yn([(e-o)/m,(t-i)/m]);return nn(a,s)};return{polarToScreen:n=>s(fn(n)),rectangularToScreen:s,screenToRectangular:d,screenToPolar:n=>(n=>{const[e,t,m]=n;return[cn(ln(un(t,e))),ln(un(m,Math.sqrt(e*e+t*t)))]})(d(n))}},pn=[];for(let n=0;n<360;n+=90){const e=[];for(let t=-90;t<=90;t++)e.push(fn([n,t]));pn.push(e)}for(let n=0;n<360;n+=15)if(n%90>0){const e=[];for(let t=-75;t<=75;t++)e.push(fn([n,t]));pn.push(e)}for(let n=-75;n<=75;n+=15){const e=[];for(let t=0;t<=360;t++)e.push(fn([t,n]));pn.push(e)}const bn=(n,e,t,m,o=[0,0])=>{n.save(),n.translate(...t),n.rotate(m),n.fillText(e,...o),n.restore()},{atan2:kn}=Math,Mn=[],Tn=[],Sn=[],xn=["N","NE","E","SE","S","SW","W","NW"];for(let n=0;n<360;n++)Mn.push(fn([n,0]));Mn.push(Mn[0]);for(let n=0;n<360;n+=45)Tn.push(fn([n,45.5])),Tn.push(fn([n,45])),Sn.push(fn([n,-44.5])),Sn.push(fn([n,-45]));const{atan2:Pn,abs:Hn}=Math,En="landmarks";let An;const Ln=(n="readonly")=>new Promise((e,t)=>{new Promise((n,e)=>{An&&n(An);const t=window.indexedDB.open(En,1);t.onsuccess=()=>{An=t.result,n(An)},t.onupgradeneeded=()=>t.result.createObjectStore(En,{keyPath:"key",autoIncrement:!0}),t.onerror=e}).then(t=>{const m=t.transaction([En],n).objectStore(En);e(m)}).catch(t)});var Fn=()=>new Promise((n,e)=>{Ln().then(t=>{const m=t.getAll();m.onsuccess=()=>n(m.result),m.onerror=e}).catch(e)}),qn=n=>new Promise((e,t)=>{Ln("readwrite").then(m=>{const o=m.put(n);o.onsuccess=()=>{m.transaction.commit(),e(o.result)},o.onerror=t}).catch(t)}),In=n=>new Promise((e,t)=>{Ln("readwrite").then(m=>{const o=m.delete(n);o.onsuccess=()=>{m.transaction.commit(),e()},o.onerror=t}).catch(t)});const Bn=await Fn();var Cn=n=>Bn.find(e=>e.key===n),$n=()=>Bn.toSorted((n,e)=>n.name>e.name?1:n.name<e.name?-1:0),Nn=()=>Bn.filter(n=>n.visible),Wn=async n=>{const e=await qn(n),t=Bn.findIndex(n=>n.key===e);-1===t?(n.key=e,Bn.push(n)):Bn[t]=n},Dn=async n=>{const e=Bn.findIndex(e=>e.key===n);e>=0&&(Bn.splice(e,1),await In(n))};const{abs:On,cos:jn,sin:Un,tan:Rn,acos:zn,atan2:Vn,PI:Gn}=Math,Yn=1e-9,{sqrt:Jn,atan2:Kn,PI:Qn}=Math,Xn=.3048,Zn=1609.344,_n=(n,e)=>{const t=Nn();if(!t.length)return;const{polarToScreen:m}=wn(n,e),{coords:o}=e.location;n.save(),n.font="bold 16px Arial, Helvetica, sans-serif",n.textAlign="left",n.textBaseline="bottom",n.shadowColor="#000000",t.forEach(e=>{let{distance:t,azimuth:i}=((n,e)=>{const{longitude:t,latitude:m}=n,{longitude:o,latitude:i}=e,a=f(t),s=f(m),d=f(o),r=f(i),l=d-a,c=On(l)<Yn&&On(r-s)<Yn,h=!c&&On(On(l)-Gn)<Yn&&On(s+r)<Yn;if(c||h)return{};const g=jn(s),u=Un(s),w=jn(r),p=Un(r),b=Rn(r),k=jn(l),M=Un(l);return{distance:6371008.8*zn(u*p+g*w*k),azimuth:y(v(Vn(M,g*b-u*k)))}})(o,e);if(t&&t>=20){let a=0;if(void 0!==e.elevation&&t<=5e4){const n=e.elevation-o.altitude;a=v(Kn(n,t)),t=Jn(t*t+n*n)}const[s,d]=m([i,a]),[r,l]=m([i+1,a]);n.save(),n.fillStyle="#ff404080",n.strokeStyle="#ffffff",n.shadowBlur=0,n.beginPath(),n.arc(s,d,10,0,2*Qn),n.fill(),n.stroke();const c=t<Zn?`${(t/Xn).toFixed(0)} ft`:`${(t/Zn).toFixed(1)} mi`,h=t<1e3?`${t.toFixed(0)} m`:`${(.001*t).toFixed(1)} km`,g=Kn(l-d,r-s);n.fillStyle="#ffffff",n.shadowBlur=5,bn(n,`${e.name} ${c} ${h}`,[s,d],g,[12,0]),n.restore()}})};var ne=n=>{const e=document.querySelector("canvas");e.width=window.innerWidth,e.height=window.innerHeight;const t=e.getContext("2d"),m=1e3/30;let o,i=performance.now();const a=()=>{o=requestAnimationFrame(a);const s=performance.now();s-i<m||(n.rotationMatrix&&(t.clearRect(0,0,e.clientWidth,e.clientHeight),((n,e)=>{const{rectangularToScreen:t}=wn(n,e);n.save(),n.lineWidth=2,n.strokeStyle="#ffffff30",n.shadowBlur=0,pn.forEach(e=>{e=e.map(n=>t(n)),n.beginPath(),n.moveTo(...e[0]);for(let t=1;t<e.length;t++)n.lineTo(...e[t]);n.stroke()}),n.restore()})(t,n),((n,e)=>{const{polarToScreen:t,screenToPolar:m}=wn(n,e),[o]=m([.5*n.canvas.width,.5*n.canvas.height]),i=[];for(let n=-90;n<=90;n++)i.push(t([o,n]));n.save(),n.lineWidth=2,n.strokeStyle="#ffffff30",n.beginPath(),n.moveTo(...i[0]);for(let e=1;e<i.length;e++)n.lineTo(...i[e]);n.stroke(),n.strokeStyle="#ffffffd0",n.fillStyle="#ffffffd0",n.shadowBlur=5,n.shadowColor="#000000",n.font="bold 16px Arial, Helvetica, sans-serif",n.textAlign="left",n.textBaseline="middle";for(let e=-89,t=1;e<=89;e++,t++){const[m,o]=i[t],[a,s]=i[t-1],d=m-a,r=o-s,l=e%5==0,c=l?1:.5;if(n.beginPath(),n.moveTo(m+r*c,o-d*c),n.lineTo(m-r*c,o+d*c),n.stroke(),l&&e){const t=1.5,i=Pn(d,-r),a=[m-r*t,o+d*t];bn(n,`${Hn(e)}`,a,i)}}n.restore()})(t,n),((n,e)=>{const{rectangularToScreen:t}=wn(n,e),m=Mn.map(t),o=Tn.map(t),i=Sn.map(t);n.save(),n.strokeStyle="#ffffffd0",n.fillStyle="#ffffffd0",n.shadowBlur=5,n.shadowColor="#000000";for(let e=0;e<360;e++){let[t,a]=m[e],[s,d]=m[e+1],r=s-t,l=d-a;const c=e%5==0,h=c?1:.5;if(n.beginPath(),n.moveTo(t+l*h,a-r*h),n.lineTo(t-l*h,a+r*h),n.stroke(),c){n.font="bold 16px Arial, Helvetica, sans-serif",n.textAlign="center",n.textBaseline="top";const m=1.5;let c=kn(l,r),h=[t-l*m,a+r*m];if(bn(n,`${e}`,h,c),e%45==0){n.font="bold 24px Arial, Helvetica, sans-serif",n.textBaseline="bottom";const g=e/45,u=`${xn[g]}`;h=[t+l*m,a-r*m],bn(n,u,h,c),[t,a]=o[2*g],[s,d]=o[2*g+1],r=s-t,l=d-a,bn(n,u,[t,a],kn(-r,l)),[t,a]=i[2*g],[s,d]=i[2*g+1],r=s-t,l=d-a,bn(n,u,[t,a],kn(-r,l))}}}n.restore()})(t,n),_n(t,n)),i=s)};a();r(document,"visibilitychange",async()=>{"visible"===document.visibilityState?void 0===o&&(i=performance.now(),a()):void 0!==o&&(cancelAnimationFrame(o),o=void 0)})};var ee=async n=>{if("denied"===(await navigator.permissions.query({name:"screen-wake-lock"})).state)return;let e;const t=async()=>{"visible"===document.visibilityState?e||(e=await navigator.wakeLock.request("screen"),e.addEventListener("release",()=>{e=void 0})):e&&e.release()};await t(),r(document,"visibilitychange",t)};let te;const me=d("lm-create"),oe=d("lm-show-list"),ie=d("lm-list-modal"),ae=d("lm-list-container"),se=d("lm-list-close"),de=d("lm-edit-modal"),re=d("lm-edit-form"),le=d("lm-edit-key"),ce=d("lm-edit-name"),he=d("lm-edit-lat"),ge=d("lm-edit-lon"),ue=d("lm-edit-elev"),fe=d("lm-edit-vis"),ve=d("lm-edit-confirm"),ye=d("lm-edit-cancel"),we=d("lm-remove-modal"),pe=d("lm-remove-key"),be=d("lm-remove-name"),ke=d("lm-remove-confirm"),Me=d("lm-remove-cancel");r(me,"click",()=>{const{latitude:n,longitude:e,altitude:t}=te.location.coords;le.value="",ce.value="",he.value=n.toFixed(6),ge.value=e.toFixed(6),ue.value=t.toFixed(0),fe.value=!0,de.showModal()});const Te=()=>{ae.innerHTML="";$n().forEach(n=>{const e="visibility "+(n.visible?"visible":"hidden"),t=a("button",{className:e});r(t,"click",()=>(async(n,e)=>{const t=Cn(n);t.visible=!t.visible,await Wn(t),e.className="visibility "+(t.visible?"visible":"hidden")})(n.key,t));const m=a("span",n.name),o=a("button",{className:"edit"});r(o,"click",()=>(n=>{const{name:e,latitude:t,longitude:m,elevation:o,visible:i}=Cn(n);le.value=n,ce.value=e,he.value=t.toFixed(6),ge.value=m.toFixed(6),ue.value=o?.toFixed(0),fe.value=i,de.showModal()})(n.key));const s=a("button",{className:"remove"});r(s,"click",()=>(n=>{const{name:e}=Cn(n);pe.value=n,be.innerHTML=`Delete ${e}?`,we.showModal()})(n.key)),i(ae,a("div",[t,m,o,s]))})};r(oe,"click",()=>{Te(),ie.showModal()});r(ve,"click",async()=>{if(!re.checkValidity())return;const n=!!le.value,e={name:ce.value,latitude:parseFloat(he.value),longitude:parseFloat(ge.value),elevation:ue.value?parseFloat(ue.value):void 0,visible:"true"===fe.value};n&&(e.key=parseInt(le.value,10)),await Wn(e),n&&Te(),de.close()});r(ke,"click",async()=>{const n=parseInt(pe.value,10);await Dn(n),Te(),we.close()}),r([se,ye,Me],"click",n=>n.target.closest("dialog").close()),r([ie,de,we],"click",n=>{n.target instanceof HTMLDialogElement&&n.target.close()});var Se=async n=>{te=n};(async()=>{const e={scale:1500},t=s("#init")[0];t.style.setProperty("display","block"),t.innerHTML="Starting camera and video ...";let m=await h();m?t.innerHTML=m:(t.innerHTML="Getting device location, please wait ...",m=await J(e),m?t.innerHTML=m:(m=dn(e),m?t.innerHTML=m:(await Se(e),t.style.setProperty("display","none"),ne(e),"development"===n&&ee())))})();
//# sourceMappingURL=index.js.map
