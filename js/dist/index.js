const n="localhost"===new URL(document.location.href).hostname?"development":"production",e=n=>n instanceof Array?n:n instanceof HTMLElement||n instanceof HTMLDocument?[n]:n instanceof HTMLCollection?Array.from(n):void 0,t=(n,t)=>{const m=e(t);if(!m)throw new Error("invalid child elements");m.forEach(e=>n.appendChild(e))},m=(n,t)=>{const m=e(n);if(!m)throw new Error("invalid target");m.forEach(n=>t(n))},o=n=>"String"===n.constructor.name||n instanceof Array||n instanceof HTMLElement||n instanceof HTMLCollection;var a=t,i=(n,...e)=>{const m=document.createElement(n),a=e.find(n=>!o(n));a&&Object.assign(m,a);const i=e.find(o);return i&&("String"===i.constructor.name?m.innerHTML=i:t(m,i)),m},s=(...n)=>{const e=n.pop(),t=n.length?n[0]:document;return Array.from(t.querySelectorAll(e))},r=n=>document.getElementById(n),d=(n,e,t)=>m(n,n=>n.addEventListener(e,t));const l={video:{facingMode:{exact:"environment"},width:{ideal:window.innerHeight},height:{ideal:window.innerWidth}}},c=async()=>{let n;try{n=await navigator.mediaDevices.getUserMedia(l)}catch{}return n};var h=async()=>{if(!navigator.mediaDevices)return"No camera available";if("denied"===(await navigator.permissions.query({name:"camera"})).state)return"Permission to use this device's camera was denied";let n=await c();if(!n)return"No front-facing camera available";const e=r("video-container");let t;const m=async()=>{"visible"===document.visibilityState?t||(n||(n=await c()),t=i("video",{autoplay:!0,mute:!0}),a(e,t),t.srcObject=n):t&&(t.srcObject.getTracks().forEach(n=>n.stop()),t.remove(),t=void 0,n=void 0)};await m(),d(document,"visibilitychange",m)};const g=Math.PI/180,f=1/g,u=n=>n*g,v=n=>n*f,y=n=>(n%=360)>=0?n:n+360;var w={rad:u,deg:v,rev:y};const p=(n,e)=>{const t=new Array(n);if(void 0!==e){const m=e instanceof Function;for(let o=0;o<n;o++)t[o]=m?e():e}return t},{sqrt:b,sin:k,cos:x,atan2:T,abs:M}=Math,S=p(13,()=>p(13)),H=p(13,()=>p(13)),P=p(13,()=>p(13)),E=p(13,()=>p(13)),A=p(13,()=>p(13)),C=p(13),L=p(13),F=p(13),q=p(13),I=p(13),B=p(13,()=>p(13)),N=p(13,()=>p(13));C[0]=0,L[0]=1,N[0][0]=1,I[0]=1,E[0][0]=0;const D=6378.137,W=6356.7523142,O=D*D,$=W*W,j=O-$,R=O*O,U=R-$*$;S[0][0]=0,H[0][0]=0;const{epoch:z,model:V}={epoch:2025,model:[{n:1,m:0,gnm:-29351.8,hnm:0,dgnm:12,dhnm:0},{n:1,m:1,gnm:-1410.8,hnm:4545.4,dgnm:9.7,dhnm:-21.5},{n:2,m:0,gnm:-2556.6,hnm:0,dgnm:-11.6,dhnm:0},{n:2,m:1,gnm:2951.1,hnm:-3133.6,dgnm:-5.2,dhnm:-27.7},{n:2,m:2,gnm:1649.3,hnm:-815.1,dgnm:-8,dhnm:-12.1},{n:3,m:0,gnm:1361,hnm:0,dgnm:-1.3,dhnm:0},{n:3,m:1,gnm:-2404.1,hnm:-56.6,dgnm:-4.2,dhnm:4},{n:3,m:2,gnm:1243.8,hnm:237.5,dgnm:.4,dhnm:-.3},{n:3,m:3,gnm:453.6,hnm:-549.5,dgnm:-15.6,dhnm:-4.1},{n:4,m:0,gnm:895,hnm:0,dgnm:-1.6,dhnm:0},{n:4,m:1,gnm:799.5,hnm:278.6,dgnm:-2.4,dhnm:-1.1},{n:4,m:2,gnm:55.7,hnm:-133.9,dgnm:-6,dhnm:4.1},{n:4,m:3,gnm:-281.1,hnm:212,dgnm:5.6,dhnm:1.6},{n:4,m:4,gnm:12.1,hnm:-375.6,dgnm:-7,dhnm:-4.4},{n:5,m:0,gnm:-233.2,hnm:0,dgnm:.6,dhnm:0},{n:5,m:1,gnm:368.9,hnm:45.4,dgnm:1.4,dhnm:-.5},{n:5,m:2,gnm:187.2,hnm:220.2,dgnm:0,dhnm:2.2},{n:5,m:3,gnm:-138.7,hnm:-122.9,dgnm:.6,dhnm:.4},{n:5,m:4,gnm:-142,hnm:43,dgnm:2.2,dhnm:1.7},{n:5,m:5,gnm:20.9,hnm:106.1,dgnm:.9,dhnm:1.9},{n:6,m:0,gnm:64.4,hnm:0,dgnm:-.2,dhnm:0},{n:6,m:1,gnm:63.8,hnm:-18.4,dgnm:-.4,dhnm:.3},{n:6,m:2,gnm:76.9,hnm:16.8,dgnm:.9,dhnm:-1.6},{n:6,m:3,gnm:-115.7,hnm:48.8,dgnm:1.2,dhnm:-.4},{n:6,m:4,gnm:-40.9,hnm:-59.8,dgnm:-.9,dhnm:.9},{n:6,m:5,gnm:14.9,hnm:10.9,dgnm:.3,dhnm:.7},{n:6,m:6,gnm:-60.7,hnm:72.7,dgnm:.9,dhnm:.9},{n:7,m:0,gnm:79.5,hnm:0,dgnm:0,dhnm:0},{n:7,m:1,gnm:-77,hnm:-48.9,dgnm:-.1,dhnm:.6},{n:7,m:2,gnm:-8.8,hnm:-14.4,dgnm:-.1,dhnm:.5},{n:7,m:3,gnm:59.3,hnm:-1,dgnm:.5,dhnm:-.8},{n:7,m:4,gnm:15.8,hnm:23.4,dgnm:-.1,dhnm:0},{n:7,m:5,gnm:2.5,hnm:-7.4,dgnm:-.8,dhnm:-1},{n:7,m:6,gnm:-11.1,hnm:-25.1,dgnm:-.8,dhnm:.6},{n:7,m:7,gnm:14.2,hnm:-2.3,dgnm:.8,dhnm:-.2},{n:8,m:0,gnm:23.2,hnm:0,dgnm:-.1,dhnm:0},{n:8,m:1,gnm:10.8,hnm:7.1,dgnm:.2,dhnm:-.2},{n:8,m:2,gnm:-17.5,hnm:-12.6,dgnm:0,dhnm:.5},{n:8,m:3,gnm:2,hnm:11.4,dgnm:.5,dhnm:-.4},{n:8,m:4,gnm:-21.7,hnm:-9.7,dgnm:-.1,dhnm:.4},{n:8,m:5,gnm:16.9,hnm:12.7,dgnm:.3,dhnm:-.5},{n:8,m:6,gnm:15,hnm:.7,dgnm:.2,dhnm:-.6},{n:8,m:7,gnm:-16.8,hnm:-5.2,dgnm:0,dhnm:.3},{n:8,m:8,gnm:.9,hnm:3.9,dgnm:.2,dhnm:.2},{n:9,m:0,gnm:4.6,hnm:0,dgnm:0,dhnm:0},{n:9,m:1,gnm:7.8,hnm:-24.8,dgnm:-.1,dhnm:-.3},{n:9,m:2,gnm:3,hnm:12.2,dgnm:.1,dhnm:.3},{n:9,m:3,gnm:-.2,hnm:8.3,dgnm:.3,dhnm:-.3},{n:9,m:4,gnm:-2.5,hnm:-3.3,dgnm:-.3,dhnm:.3},{n:9,m:5,gnm:-13.1,hnm:-5.2,dgnm:0,dhnm:.2},{n:9,m:6,gnm:2.4,hnm:7.2,dgnm:.3,dhnm:-.1},{n:9,m:7,gnm:8.6,hnm:-.6,dgnm:-.1,dhnm:-.2},{n:9,m:8,gnm:-8.7,hnm:.8,dgnm:.1,dhnm:.4},{n:9,m:9,gnm:-12.9,hnm:10,dgnm:-.1,dhnm:.1},{n:10,m:0,gnm:-1.3,hnm:0,dgnm:.1,dhnm:0},{n:10,m:1,gnm:-6.4,hnm:3.3,dgnm:0,dhnm:0},{n:10,m:2,gnm:.2,hnm:0,dgnm:.1,dhnm:0},{n:10,m:3,gnm:2,hnm:2.4,dgnm:.1,dhnm:-.2},{n:10,m:4,gnm:-1,hnm:5.3,dgnm:0,dhnm:.1},{n:10,m:5,gnm:-.6,hnm:-9.1,dgnm:-.3,dhnm:-.1},{n:10,m:6,gnm:-.9,hnm:.4,dgnm:0,dhnm:.1},{n:10,m:7,gnm:1.5,hnm:-4.2,dgnm:-.1,dhnm:0},{n:10,m:8,gnm:.9,hnm:-3.8,dgnm:-.1,dhnm:-.1},{n:10,m:9,gnm:-2.7,hnm:.9,dgnm:0,dhnm:.2},{n:10,m:10,gnm:-3.9,hnm:-9.1,dgnm:0,dhnm:0},{n:11,m:0,gnm:2.9,hnm:0,dgnm:0,dhnm:0},{n:11,m:1,gnm:-1.5,hnm:0,dgnm:0,dhnm:0},{n:11,m:2,gnm:-2.5,hnm:2.9,dgnm:0,dhnm:.1},{n:11,m:3,gnm:2.4,hnm:-.6,dgnm:0,dhnm:0},{n:11,m:4,gnm:-.6,hnm:.2,dgnm:0,dhnm:.1},{n:11,m:5,gnm:-.1,hnm:.5,dgnm:-.1,dhnm:0},{n:11,m:6,gnm:-.6,hnm:-.3,dgnm:0,dhnm:0},{n:11,m:7,gnm:-.1,hnm:-1.2,dgnm:0,dhnm:.1},{n:11,m:8,gnm:1.1,hnm:-1.7,dgnm:-.1,dhnm:0},{n:11,m:9,gnm:-1,hnm:-2.9,dgnm:-.1,dhnm:0},{n:11,m:10,gnm:-.2,hnm:-1.8,dgnm:-.1,dhnm:0},{n:11,m:11,gnm:2.6,hnm:-2.3,dgnm:-.1,dhnm:0},{n:12,m:0,gnm:-2,hnm:0,dgnm:0,dhnm:0},{n:12,m:1,gnm:-.2,hnm:-1.3,dgnm:0,dhnm:0},{n:12,m:2,gnm:.3,hnm:.7,dgnm:0,dhnm:0},{n:12,m:3,gnm:1.2,hnm:1,dgnm:0,dhnm:-.1},{n:12,m:4,gnm:-1.3,hnm:-1.4,dgnm:0,dhnm:.1},{n:12,m:5,gnm:.6,hnm:0,dgnm:0,dhnm:0},{n:12,m:6,gnm:.6,hnm:.6,dgnm:.1,dhnm:0},{n:12,m:7,gnm:.5,hnm:-.1,dgnm:0,dhnm:0},{n:12,m:8,gnm:-.1,hnm:.8,dgnm:0,dhnm:0},{n:12,m:9,gnm:-.4,hnm:.1,dgnm:0,dhnm:0},{n:12,m:10,gnm:-.2,hnm:-1,dgnm:-.1,dhnm:0},{n:12,m:11,gnm:-1.3,hnm:.1,dgnm:0,dhnm:0},{n:12,m:12,gnm:-.7,hnm:.2,dgnm:-.1,dhnm:-.1}]};V.forEach(n=>{const{n:e,m:t,gnm:m,hnm:o,dgnm:a,dhnm:i}=n;t<=e&&(S[t][e]=m,H[t][e]=a,0!==t&&(S[e][t-1]=o,H[e][t-1]=i))}),A[0][0]=1,q[0]=0;for(let n=1;n<=12;n++){A[0][n]=A[0][n-1]*(2*n-1)/n;let e=2;for(let t=0,m=n-t+1;m>0;m--,t++){if(B[t][n]=((n-1)*(n-1)-t*t)/((2*n-1)*(2*n-3)),t>0){const m=(n-t+1)*e/(n+t);A[t][n]=A[t-1][n]*b(m),e=1,S[n][t-1]=A[t][n]*S[n][t-1],H[n][t-1]=A[t][n]*H[n][t-1]}S[t][n]=A[t][n]*S[t][n],H[t][n]=A[t][n]*H[t][n]}F[n]=n+1,q[n]=n}B[1][1]=0;const G=(n,e)=>{const{latitude:t,longitude:m,altitude:o}=n,a=(n=>{const e=(n=n||new Date).getUTCFullYear(),t=24*(365+(e%400==0||e%4==0&&e%100>0?1:0))*60*60*1e3;return e+(n.valueOf()-Date.UTC(e,0))/t})(e),i=a-z,s=u(t),r=u(m),d=k(r),l=k(s),c=x(r),h=x(s),g=l*l,f=h*h;C[1]=d,L[1]=c;const y=b(O-j*g),w=o*y,p=l/b((w+O)/(w+$)*((w+O)/(w+$))*f+g),A=b(1-p*p),D=b(o*o+2*w+(R-U*g)/(y*y)),W=b(O*f+$*g),V=(o+W)/D,G=j*h*l/(D*W);for(let n=2;n<=12;n++)C[n]=C[1]*L[n-1]+L[1]*C[n-1],L[n]=L[1]*L[n-1]-C[1]*C[n-1];const Y=6371.2/D;let J=Y*Y,K=0,Q=0,X=0,Z=0;for(let n=1;n<=12;n++){J*=Y;for(let e=0,t=n+e+1;t>0;t--,e++){n===e?(N[e][n]=A*N[e-1][n-1],E[e][n]=A*E[e-1][n-1]+p*N[e-1][n-1]):1===n&&0===e?(N[e][n]=p*N[e][n-1],E[e][n]=p*E[e][n-1]-A*N[e][n-1]):n>1&&n!==e&&(e>n-2&&(N[e][n-2]=0),e>n-2&&(E[e][n-2]=0),N[e][n]=p*N[e][n-1]-B[e][n]*N[e][n-2],E[e][n]=p*E[e][n-1]-A*N[e][n-1]-B[e][n]*E[e][n-2]),P[e][n]=S[e][n]+i*H[e][n],0!==e&&(P[n][e-1]=S[n][e-1]+i*H[n][e-1]);const t=J*N[e][n];let m,o;if(0===e?(m=P[e][n]*L[e],o=P[e][n]*C[e]):(m=P[e][n]*L[e]+P[n][e-1]*C[e],o=P[e][n]*C[e]-P[n][e-1]*L[e]),Q-=J*m*E[e][n],X+=q[e]*o*t,K+=F[n]*m*t,0===A&&1===e){I[n]=1===n?I[n-1]:p*I[n-1]-B[e][n]*I[n-2];const t=J*I[n];Z+=q[e]*o*t}}}X=0===A?Z:X/A;const _=-Q*V-K*G,nn=X,en=Q*G-K*V,tn=b(_*_+nn*nn),mn=b(tn*tn+en*en),on=v(T(nn,_)),an=v(T(en,tn));let sn=-999;return M(t)>=55&&(t>0&&m>=0&&(sn=on-m),t>0&&m<0&&(sn=on+M(m)),t<0&&m>=0&&(sn=on+m),t<0&&m<0&&(sn=on-M(m)),sn>180&&(sn-=360),sn<-180&&(sn+=360)),{declination:on,inclination:an,intensity:mn,gridVariation:sn}},Y={scale:1500,location:void 0,rotationMatrix:void 0,canvasContext:void 0},J=()=>{const n=new Promise((n,e)=>{navigator.geolocation.getCurrentPosition(e=>{const{declination:t}=G(e.coords);e.declination=t,n(e)},()=>n())});return n};var K=async()=>{if("denied"===(await navigator.permissions.query({name:"geolocation"})).state)return"Permission to use this device's location was denied";let n,e=await J();if(!e)return"Could not get a location for this device";Y.location=e;const t=()=>{"visible"===document.visibilityState?n||(n=setInterval(async()=>{e=await J(),e&&(Y.location=e)},1e3)):n&&(clearInterval(n),n=void 0)};t(),d(document,"visibilitychange",t)};const Q=n=>{const e=w.rad(n);return{"cosθ":Math.cos(e),"sinθ":Math.sin(e)}};var X=n=>{const{"cosθ":e,"sinθ":t}=Q(n);return[[1,0,0],[0,e,-t],[0,t,e]]},Z=n=>{const{"cosθ":e,"sinθ":t}=Q(n);return[[e,0,t],[0,1,0],[-t,0,e]]},_=n=>{const{"cosθ":e,"sinθ":t}=Q(n);return[[e,-t,0],[t,e,0],[0,0,1]]},nn=(...n)=>{let e,t=n[0];for(let m=1;m<n.length;m++){const o=n[m];e=[[],[],[]];for(let n=0;n<3;n++)for(let m=0;m<3;m++)e[n][m]=t[n][0]*o[0][m]+t[n][1]*o[1][m]+t[n][2]*o[2][m];t=e}return e},en=(n,e)=>{const[t,m,o]=e,a=[];for(let e=0;e<3;e++)a[e]=n[e][0]*t+n[e][1]*m+n[e][2]*o;return a},tn=n=>{const[e,t,m]=n[0],[o,a,i]=n[1],[s,r,d]=n[2],l=a*d-i*r,c=-(o*d-i*s),h=o*r-a*s,g=e*l+t*c+m*h;return[[l/g,-(t*d-m*r)/g,(t*i-m*a)/g],[c/g,(e*d-m*s)/g,-(e*i-m*o)/g],[h/g,-(e*r-t*s)/g,(e*a-t*o)/g]]};const{atan2:mn,abs:on,sign:an,asin:sn}=Math,rn=.5*Math.PI;var dn=()=>{if(!AbsoluteOrientationSensor)return"Orientation sensor is not supported on this device";const n=new AbsoluteOrientationSensor({frequency:30});n.onreading=()=>{if(!Y.location)return;const[e,t,m,o]=n.quaternion,a=v(mn(2*(o*e+t*m),1-2*(e*e+t*t))),i=2*(o*t-m*e);let s=v(on(i>1)?an(i)*rn:sn(i));let r=v(mn(2*(o*m+e*t),1-2*(t*t+m*m)));s=360-s,r=y(r-90-Y.location.declination),Y.rotationMatrix=nn(X(a),Z(s),_(r))},n.start();d(document,"visibilitychange",()=>{"visible"===document.visibilityState?n.start():n.stop()})};const{rad:ln,deg:cn,rev:hn}=w,{cos:gn,sin:fn,atan2:un}=Math,vn=n=>{let[e,t]=n;e=ln(e),t=ln(t);const m=gn(t);return[gn(e)*m,fn(e)*m,fn(t)]};var yn=n=>{const[e,t,m]=n,o=1-m;return[e/o,t/o]},wn=n=>{const[e,t]=n,m=e*e+t*t,o=m+1;return[2*e/o,2*t/o,(m-1)/o]};const pn=()=>{const{scale:n,rotationMatrix:e,canvasContext:t}=Y,m=.5*t.canvas.clientWidth,o=.5*t.canvas.clientHeight,a=tn(e),i=t=>{const a=en(e,t),[i,s]=yn(a);return[i*n+m,s*n+o]},s=e=>{const[t,i]=e,s=wn([(t-m)/n,(i-o)/n]);return en(a,s)};return{polarToScreen:n=>i(vn(n)),rectangularToScreen:i,screenToRectangular:s,screenToPolar:n=>(n=>{const[e,t,m]=n;return[hn(cn(un(t,e))),cn(un(m,Math.sqrt(e*e+t*t)))]})(s(n))}},bn=[];for(let n=0;n<360;n+=90){const e=[];for(let t=-90;t<=90;t++)e.push(vn([n,t]));bn.push(e)}for(let n=0;n<360;n+=15)if(n%90>0){const e=[];for(let t=-75;t<=75;t++)e.push(vn([n,t]));bn.push(e)}for(let n=-75;n<=75;n+=15){const e=[];for(let t=0;t<=360;t++)e.push(vn([t,n]));bn.push(e)}const kn=(n,e,t,m,o=[0,0])=>{n.save(),n.translate(...t),n.rotate(m),n.fillText(e,...o),n.restore()},{atan2:xn}=Math,Tn=[],Mn=[],Sn=[],Hn=["N","NE","E","SE","S","SW","W","NW"];for(let n=0;n<360;n++)Tn.push(vn([n,0]));Tn.push(Tn[0]);for(let n=0;n<360;n+=45)Mn.push(vn([n,45.5])),Mn.push(vn([n,45])),Sn.push(vn([n,-44.5])),Sn.push(vn([n,-45]));const{atan2:Pn,abs:En}=Math,An="landmarks";let Cn;const Ln=(n="readonly")=>new Promise((e,t)=>{new Promise((n,e)=>{Cn&&n(Cn);const t=window.indexedDB.open(An,1);t.onsuccess=()=>{Cn=t.result,n(Cn)},t.onupgradeneeded=()=>t.result.createObjectStore(An,{keyPath:"key",autoIncrement:!0}),t.onerror=e}).then(t=>{const m=t.transaction([An],n).objectStore(An);e(m)}).catch(t)});var Fn=()=>new Promise((n,e)=>{Ln().then(t=>{const m=t.getAll();m.onsuccess=()=>n(m.result),m.onerror=e}).catch(e)}),qn=n=>new Promise((e,t)=>{Ln("readwrite").then(m=>{const o=m.put(n);o.onsuccess=()=>{m.transaction.commit(),e(o.result)},o.onerror=t}).catch(t)}),In=n=>new Promise((e,t)=>{Ln("readwrite").then(m=>{const o=m.delete(n);o.onsuccess=()=>{m.transaction.commit(),e()},o.onerror=t}).catch(t)});const Bn=await Fn();var Nn=n=>Bn.find(e=>e.key===n),Dn=()=>Bn.toSorted((n,e)=>n.name>e.name?1:n.name<e.name?-1:0),Wn=()=>Bn.filter(n=>n.visible),On=async n=>{const e=await qn(n),t=Bn.findIndex(n=>n.key===e);-1===t?(n.key=e,Bn.push(n)):Bn[t]=n},$n=async n=>{const e=Bn.findIndex(e=>e.key===n);e>=0&&(Bn.splice(e,1),await In(n))};const{abs:jn,cos:Rn,sin:Un,tan:zn,acos:Vn,atan2:Gn,PI:Yn}=Math,Jn=1e-9,{sqrt:Kn,atan2:Qn}=Math,Xn=()=>{const n=Wn();if(!n.length)return;const{canvasContext:e}=Y,{polarToScreen:t}=pn(),{coords:m}=Y.location,o=new Intl.NumberFormat(void 0,{maximumSignificantDigits:3});e.save(),e.font="bold 24px Arial, Helvetica, sans-serif",e.textAlign="left",e.textBaseline="bottom",e.shadowColor="#000000",n.forEach(n=>{let{distance:a,azimuth:i}=((n,e)=>{const{longitude:t,latitude:m}=n,{longitude:o,latitude:a}=e,i=u(t),s=u(m),r=u(o),d=u(a),l=r-i,c=jn(l)<Jn&&jn(d-s)<Jn,h=!c&&jn(jn(l)-Yn)<Jn&&jn(s+d)<Jn;if(c||h)return{};const g=Rn(s),f=Un(s),w=Rn(d),p=Un(d),b=zn(d),k=Rn(l),x=Un(l);return{distance:6371008.8*Vn(f*p+g*w*k),azimuth:y(v(Gn(x,g*b-f*k)))}})(m,n);if(a&&a>=10){e.save();let s=0;if(void 0!==n.elevation&&a<=5e4){const e=n.elevation-m.altitude;s=v(Qn(e,a)),a=Kn(a*a+e*e)}const[r,d]=t([i,s]),[l,c]=t([i+1,s]),h=l-r,g=c-d;let f;e.translate(r,d),e.rotate(Qn(g,h)),e.fillStyle="#ffff8080",e.strokeStyle="#ffff80",e.fillRect(-10,-10,20,20),e.strokeRect(-10,-10,20,20),a/=.3048,f=a<5280?`${o.format(a)} ft`:`${o.format(a/5280)} mi`,e.fillStyle="#ffff80",e.shadowBlur=5,e.fillText(n.name,20,-20),e.fillText(f,20,-6),e.restore()}}),e.restore()};var Zn=()=>{const n=document.querySelector("canvas");n.width=window.innerWidth,n.height=window.innerHeight;const e=n.getContext("2d");Y.canvasContext=e;const t=1e3/30;let m,o=performance.now();const a=()=>{m=requestAnimationFrame(a);const i=performance.now();i-o<t||(Y.rotationMatrix&&(e.clearRect(0,0,n.clientWidth,n.clientHeight),(()=>{const{canvasContext:n}=Y,{rectangularToScreen:e}=pn();n.save(),n.lineWidth=2,n.strokeStyle="#ffffff30",n.shadowBlur=0,bn.forEach(t=>{t=t.map(n=>e(n)),n.beginPath(),n.moveTo(...t[0]);for(let e=1;e<t.length;e++)n.lineTo(...t[e]);n.stroke()}),n.restore()})(),(()=>{const{canvasContext:n}=Y,{polarToScreen:e,screenToPolar:t}=pn(),[m]=t([.5*n.canvas.width,.5*n.canvas.height]),o=[];for(let n=-90;n<=90;n++)o.push(e([m,n]));n.save(),n.lineWidth=2,n.strokeStyle="#ffffff30",n.beginPath(),n.moveTo(...o[0]);for(let e=1;e<o.length;e++)n.lineTo(...o[e]);n.stroke(),n.strokeStyle="#ffffffd0",n.fillStyle="#ffffffd0",n.shadowBlur=5,n.shadowColor="#000000",n.font="bold 16px Arial, Helvetica, sans-serif",n.textAlign="left",n.textBaseline="middle";for(let e=-89,t=1;e<=89;e++,t++){const[m,a]=o[t],[i,s]=o[t-1],r=m-i,d=a-s,l=e%5==0,c=l?1:.5;if(n.beginPath(),n.moveTo(m+d*c,a-r*c),n.lineTo(m-d*c,a+r*c),n.stroke(),l&&e){const t=1.5,o=Pn(r,-d),i=[m-d*t,a+r*t];kn(n,`${En(e)}`,i,o)}}n.restore()})(),(()=>{const{canvasContext:n}=Y,{rectangularToScreen:e}=pn(),t=Tn.map(e),m=Mn.map(e),o=Sn.map(e);n.save(),n.strokeStyle="#ffffffd0",n.fillStyle="#ffffffd0",n.shadowBlur=5,n.shadowColor="#000000";for(let e=0;e<360;e++){let[a,i]=t[e],[s,r]=t[e+1],d=s-a,l=r-i;const c=e%5==0,h=c?1:.5;if(n.beginPath(),n.moveTo(a+l*h,i-d*h),n.lineTo(a-l*h,i+d*h),n.stroke(),c){n.font="bold 16px Arial, Helvetica, sans-serif",n.textAlign="center",n.textBaseline="top";const t=1.5;let c=xn(l,d),h=[a-l*t,i+d*t];if(kn(n,`${e}`,h,c),e%45==0){n.font="bold 24px Arial, Helvetica, sans-serif",n.textBaseline="bottom";const g=e/45,f=`${Hn[g]}`;h=[a+l*t,i-d*t],kn(n,f,h,c),[a,i]=m[2*g],[s,r]=m[2*g+1],d=s-a,l=r-i,kn(n,f,[a,i],xn(-d,l)),[a,i]=o[2*g],[s,r]=o[2*g+1],d=s-a,l=r-i,kn(n,f,[a,i],xn(-d,l))}}}n.restore()})(),Xn()),o=i)};a();d(document,"visibilitychange",async()=>{"visible"===document.visibilityState?void 0===m&&(o=performance.now(),a()):void 0!==m&&(cancelAnimationFrame(m),m=void 0)})};var _n=async n=>{if("denied"===(await navigator.permissions.query({name:"screen-wake-lock"})).state)return;let e;const t=async()=>{"visible"===document.visibilityState?e||(e=await navigator.wakeLock.request("screen"),e.addEventListener("release",()=>{e=void 0})):e&&e.release()};await t(),d(document,"visibilitychange",t)};var ne=()=>{const n=r("lm-create"),e=r("lm-show-list"),t=r("lm-list-modal"),m=r("lm-list-container"),o=r("lm-list-close"),s=r("lm-edit-modal"),l=r("lm-edit-form"),c=r("lm-edit-key"),h=r("lm-edit-name"),g=r("lm-edit-lat"),f=r("lm-edit-lon"),u=r("lm-edit-elev"),v=r("lm-edit-vis"),y=r("lm-edit-confirm"),w=r("lm-edit-cancel"),p=r("lm-remove-modal"),b=r("lm-remove-key"),k=r("lm-remove-name"),x=r("lm-remove-confirm"),T=r("lm-remove-cancel");d(n,"click",()=>{const{latitude:n,longitude:e,altitude:t}=Y.location.coords;c.value="",h.value="",g.value=n.toFixed(6),f.value=e.toFixed(6),u.value=t.toFixed(0),v.value=!0,s.showModal()});const M=()=>{m.innerHTML="";Dn().forEach(n=>{const e="visibility "+(n.visible?"visible":"hidden"),t=i("button",{className:e});d(t,"click",()=>(async(n,e)=>{const t=Nn(n);t.visible=!t.visible,await On(t),e.className="visibility "+(t.visible?"visible":"hidden")})(n.key,t));const o=i("span",n.name),r=i("button",{className:"edit"});d(r,"click",()=>(n=>{const{name:e,latitude:t,longitude:m,elevation:o,visible:a}=Nn(n);c.value=n,h.value=e,g.value=t.toFixed(6),f.value=m.toFixed(6),u.value=o?.toFixed(0),v.value=a,s.showModal()})(n.key));const l=i("button",{className:"remove"});d(l,"click",()=>(n=>{const{name:e}=Nn(n);b.value=n,k.innerHTML=`Delete ${e}?`,p.showModal()})(n.key)),a(m,i("div",[t,o,r,l]))})};d(e,"click",()=>{M(),t.showModal()});d(y,"click",async()=>{if(!l.checkValidity())return;const n=!!c.value,e={name:h.value,latitude:parseFloat(g.value),longitude:parseFloat(f.value),elevation:u.value?parseFloat(u.value):void 0,visible:"true"===v.value};n&&(e.key=parseInt(c.value,10)),await On(e),n&&M(),s.close()});d(x,"click",async()=>{const n=parseInt(b.value,10);await $n(n),M(),p.close()}),d([o,w,T],"click",n=>n.target.closest("dialog").close()),d([t,s,p],"click",n=>{n.target instanceof HTMLDialogElement&&n.target.close()})};(async()=>{const e=s("#init")[0];e.style.setProperty("display","block"),e.innerHTML="Starting camera and video ...";let t=await h();t?e.innerHTML=t:(e.innerHTML="Getting device location, please wait ...",t=await K(),t?e.innerHTML=t:(t=dn(),t?e.innerHTML=t:(ne(),e.style.setProperty("display","none"),Zn(),"development"===n&&_n())))})();
//# sourceMappingURL=index.js.map
